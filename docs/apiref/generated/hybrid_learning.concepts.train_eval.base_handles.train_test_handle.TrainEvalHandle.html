<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TrainEvalHandle &mdash; hybrid_learning  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/autoclasstoc.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="callbacks" href="hybrid_learning.concepts.train_eval.callbacks.html" />
    <link rel="prev" title="train_test_handle" href="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> hybrid_learning
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Content</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/index.html">Quickstart Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../userguide/index.html">User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="hybrid_learning.concepts.html">concepts</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="hybrid_learning.concepts.analysis.html">analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="hybrid_learning.concepts.concepts.html">concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="hybrid_learning.concepts.models.html">models</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="hybrid_learning.concepts.train_eval.html">train_eval</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="hybrid_learning.concepts.train_eval.base_handles.html">base_handles</a></li>
<li class="toctree-l4"><a class="reference internal" href="hybrid_learning.concepts.train_eval.callbacks.html">callbacks</a></li>
<li class="toctree-l4"><a class="reference internal" href="hybrid_learning.concepts.train_eval.hessian.html">hessian</a></li>
<li class="toctree-l4"><a class="reference internal" href="hybrid_learning.concepts.train_eval.kpis.html">kpis</a></li>
<li class="toctree-l4"><a class="reference internal" href="hybrid_learning.concepts.train_eval.train_eval_funs.html">train_eval_funs</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="hybrid_learning.datasets.html">datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="hybrid_learning.fuzzy_logic.html">fuzzy_logic</a></li>
<li class="toctree-l2"><a class="reference internal" href="hybrid_learning.experimentation.html">experimentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">How to contribute</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">hybrid_learning</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">API Reference</a> &raquo;</li>
          <li><a href="hybrid_learning.concepts.html">concepts</a> &raquo;</li>
          <li><a href="hybrid_learning.concepts.train_eval.html">train_eval</a> &raquo;</li>
          <li><a href="hybrid_learning.concepts.train_eval.base_handles.html">base_handles</a> &raquo;</li>
          <li><a href="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.html">train_test_handle</a> &raquo;</li>
      <li>TrainEvalHandle</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/apiref/generated/hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="trainevalhandle">
<h1>TrainEvalHandle<a class="headerlink" href="#trainevalhandle" title="Permalink to this headline"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hybrid_learning.concepts.train_eval.base_handles.train_test_handle.</span></span><span class="sig-name descname"><span class="pre">TrainEvalHandle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size_hessian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nll_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_fns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">early_stopping_handle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_input_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress_bars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/train_eval/base_handles/train_test_handle.html#TrainEvalHandle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.6/library/abc.html#abc.ABC" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>Handle for training and evaluation of pytorch models.
The model base class should be <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v1.11.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></a>.</p>
<p>The main functions are <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.train" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.train"><code class="xref py py-meth docutils literal notranslate"><span class="pre">train()</span></code></a> and <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.evaluate" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.evaluate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">evaluate()</span></code></a>.
Metrics and loss functions must be given on initialization.
Training and evaluation results are returned as
<code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> resp. <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.Series</span></code> with columns
the metric keys (prefixed according to the mode).
Modes can be train, test, or validation (see instances of
<a class="reference internal" href="hybrid_learning.datasets.base.DatasetSplit.html#hybrid_learning.datasets.base.DatasetSplit" title="hybrid_learning.datasets.base.DatasetSplit"><code class="xref py py-class docutils literal notranslate"><span class="pre">DatasetSplit</span></code></a> enum).
The non-prefixed loss key is saved in <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.LOSS_KEY" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.LOSS_KEY"><code class="xref py py-const docutils literal notranslate"><span class="pre">LOSS_KEY</span></code></a>.</p>
<p>For a usage example see
<a class="reference internal" href="hybrid_learning.concepts.models.concept_models.concept_detection.ConceptDetection2DTrainTestHandle.html#hybrid_learning.concepts.models.concept_models.concept_detection.ConceptDetection2DTrainTestHandle" title="hybrid_learning.concepts.models.concept_models.concept_detection.ConceptDetection2DTrainTestHandle"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConceptDetection2DTrainTestHandle</span></code></a>.</p>
<div class="autoclasstoc docutils container">
<p class="rubric">Public Data Attributes:</p>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.LOSS_KEY" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.LOSS_KEY"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LOSS_KEY</span></code></a></p></td>
<td><p>Key for the loss evaluation results.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.NLL_KEY" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.NLL_KEY"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NLL_KEY</span></code></a></p></td>
<td><p>Key for the proper scoring evaluation function used for second stage training.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.kpi_fns" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.kpi_fns"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kpi_fns</span></code></a></p></td>
<td><p>Metric <em>and</em> loss functions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.settings" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.settings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">settings</span></code></a></p></td>
<td><p>The current training settings as dictionary.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="autoclasstoc docutils container">
<p class="rubric">Public Methods:</p>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.add_callbacks" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.add_callbacks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_callbacks</span></code></a>(callbacks)</p></td>
<td><p>Append the given callbacks.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.remove_callback" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.remove_callback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_callback</span></code></a>(callback)</p></td>
<td><p>Remove a single given callback.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.loader" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.loader"><code class="xref py py-obj docutils literal notranslate"><span class="pre">loader</span></code></a>([data, mode, batch_size, shuffle, ...])</p></td>
<td><p>Prepare and return a torch data loader from the dataset according to settings.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.reset_optimizer" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.reset_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset_optimizer</span></code></a>([optimizer, device, model])</p></td>
<td><p>Move model to correct device, init optimizer to parameters of model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.reset_training_handles" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.reset_training_handles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset_training_handles</span></code></a>([optimizer, device, ...])</p></td>
<td><p>(Re)set all handles associated with training, and move to <code class="docutils literal notranslate"><span class="pre">device</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.reset_kpis" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.reset_kpis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset_kpis</span></code></a>([kpis])</p></td>
<td><p>Resets aggregating kpis</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.train" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a>([train_loader, val_loader, ...])</p></td>
<td><p>Train the model according to the specified training parameters.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.cross_validate" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.cross_validate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cross_validate</span></code></a>([num_splits, train_val_data, ...])</p></td>
<td><p>Record training results for <code class="docutils literal notranslate"><span class="pre">num_splits</span></code> distinct val splits.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.train_val_one_epoch" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.train_val_one_epoch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_val_one_epoch</span></code></a>([pbar_desc, ...])</p></td>
<td><p>Train for one epoch, evaluate, and return history and test results.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.train_one_epoch" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.train_one_epoch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_one_epoch</span></code></a>([train_loader, ...])</p></td>
<td><p>Train for one epoch and return history results as <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.evaluate" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a>([mode, val_loader, prefix, ...])</p></td>
<td><p>Evaluate the model wrt.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.second_stage_train" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.second_stage_train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">second_stage_train</span></code></a>([callback_context])</p></td>
<td><p>Do a second stage training for calibration using Laplace approximation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="autoclasstoc docutils container">
<p class="rubric">Special Methods:</p>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.__repr__" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.__repr__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__repr__</span></code></a>()</p></td>
<td><p>Return repr(self).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.__init__" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(model, data[, device, batch_size, ...])</p></td>
<td><p>Init.</p></td>
</tr>
</tbody>
</table>
</div>
<hr class="docutils" />
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Module</em>) – </p></li>
<li><p><strong>data</strong> (<a class="reference internal" href="hybrid_learning.datasets.base.DataTriple.html#hybrid_learning.datasets.base.DataTriple" title="hybrid_learning.datasets.base.DataTriple"><em>DataTriple</em></a>) – </p></li>
<li><p><strong>device</strong> (<em>device</em>) – </p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – </p></li>
<li><p><strong>batch_size_val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – </p></li>
<li><p><strong>batch_size_hessian</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – </p></li>
<li><p><strong>max_epochs</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – </p></li>
<li><p><strong>num_workers</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – </p></li>
<li><p><strong>loss_fn</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Callable" title="(in Python v3.6)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><em>Tensor</em></a><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><em>Tensor</em></a><em>]</em><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><em>Tensor</em></a><em>]</em>) – </p></li>
<li><p><strong>nll_fn</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Callable" title="(in Python v3.6)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><em>Tensor</em></a><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><em>Tensor</em></a><em>]</em><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><em>Tensor</em></a><em>]</em>) – </p></li>
<li><p><strong>metric_fns</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Dict" title="(in Python v3.6)"><em>Dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Union" title="(in Python v3.6)"><em>Union</em></a><em>[</em><a class="reference internal" href="hybrid_learning.concepts.train_eval.kpis.aggregating_kpis.AggregatingKpi.html#hybrid_learning.concepts.train_eval.kpis.aggregating_kpis.AggregatingKpi" title="hybrid_learning.concepts.train_eval.kpis.aggregating_kpis.AggregatingKpi"><em>AggregatingKpi</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Callable" title="(in Python v3.6)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><em>Tensor</em></a><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><em>Tensor</em></a><em>]</em><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><em>Tensor</em></a><em>]</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>early_stopping_handle</strong> (<a class="reference internal" href="hybrid_learning.concepts.train_eval.base_handles.early_stopping.EarlyStoppingHandle.html#hybrid_learning.concepts.train_eval.base_handles.early_stopping.EarlyStoppingHandle" title="hybrid_learning.concepts.train_eval.base_handles.early_stopping.EarlyStoppingHandle"><em>EarlyStoppingHandle</em></a>) – </p></li>
<li><p><strong>optimizer</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Callable" title="(in Python v3.6)"><em>Callable</em></a><em>[</em><em>[</em><em>...</em><em>]</em><em>, </em><a class="reference internal" href="https://pytorch.org/docs/stable/optim.html#torch.optim.Optimizer" title="torch.optim.Optimizer"><code class="docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></a><em>]</em>) – </p></li>
<li><p><strong>model_output_transform</strong> (<a class="reference internal" href="hybrid_learning.datasets.transforms.tuple_transforms.TupleTransforms.html#hybrid_learning.datasets.transforms.tuple_transforms.TupleTransforms" title="hybrid_learning.datasets.transforms.tuple_transforms.TupleTransforms"><em>TupleTransforms</em></a>) – </p></li>
<li><p><strong>metric_input_transform</strong> (<a class="reference internal" href="hybrid_learning.datasets.transforms.tuple_transforms.TupleTransforms.html#hybrid_learning.datasets.transforms.tuple_transforms.TupleTransforms" title="hybrid_learning.datasets.transforms.tuple_transforms.TupleTransforms"><em>TupleTransforms</em></a>) – </p></li>
<li><p><strong>callbacks</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.List" title="(in Python v3.6)"><em>List</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Mapping" title="(in Python v3.6)"><em>Mapping</em></a><em>[</em><a class="reference internal" href="hybrid_learning.concepts.train_eval.callbacks.CallbackEvents.html#hybrid_learning.concepts.train_eval.callbacks.CallbackEvents" title="hybrid_learning.concepts.train_eval.callbacks.CallbackEvents"><em>CallbackEvents</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Callable" title="(in Python v3.6)"><em>Callable</em></a><em>]</em><em>]</em>) – </p></li>
<li><p><strong>callback_context</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Dict" title="(in Python v3.6)"><em>Dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Any" title="(in Python v3.6)"><em>Any</em></a><em>]</em>) – </p></li>
<li><p><strong>show_progress_bars</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Union" title="(in Python v3.6)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size_hessian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nll_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_fns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">early_stopping_handle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_input_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress_bars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/train_eval/base_handles/train_test_handle.html#TrainEvalHandle.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Init.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Module</em>) – model to train/eval</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><em>device</em><em>]</em>) – device on which to load the data and the model parameters</p></li>
<li><p><strong>num_workers</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>]</em>) – number of workers to use for data loading;
see <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.loader" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.loader"><code class="xref py py-meth docutils literal notranslate"><span class="pre">loader()</span></code></a>; single process loading is used if unset or &lt;2</p></li>
<li><p><strong>optimizer</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Callable" title="(in Python v3.6)"><em>Callable</em></a><em>[</em><em>[</em><em>...</em><em>]</em><em>, </em><a class="reference internal" href="https://pytorch.org/docs/stable/optim.html#torch.optim.Optimizer" title="torch.optim.Optimizer"><code class="docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></a><em>]</em><em>]</em>) – callable that yields a fresh optimizer instance
when called on the model’s trainable parameters</p></li>
<li><p><strong>early_stopping_handle</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference internal" href="hybrid_learning.concepts.train_eval.base_handles.early_stopping.EarlyStoppingHandle.html#hybrid_learning.concepts.train_eval.base_handles.early_stopping.EarlyStoppingHandle" title="hybrid_learning.concepts.train_eval.base_handles.early_stopping.EarlyStoppingHandle"><em>EarlyStoppingHandle</em></a><em>]</em>) – handle for early stopping;
defaults to default
<a class="reference internal" href="hybrid_learning.concepts.train_eval.base_handles.early_stopping.EarlyStoppingHandle.html#hybrid_learning.concepts.train_eval.base_handles.early_stopping.EarlyStoppingHandle" title="hybrid_learning.concepts.train_eval.base_handles.early_stopping.EarlyStoppingHandle"><code class="xref py py-class docutils literal notranslate"><span class="pre">EarlyStoppingHandle</span></code></a>
if <code class="docutils literal notranslate"><span class="pre">None</span></code>; set to <code class="docutils literal notranslate"><span class="pre">False</span></code> to disable early stopping;</p></li>
<li><p><strong>loss_fn</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Callable" title="(in Python v3.6)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><em>Tensor</em></a><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><em>Tensor</em></a><em>]</em><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><em>Tensor</em></a><em>]</em><em>]</em>) – differentiable metric function to use as loss</p></li>
<li><p><strong>nll_fn</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Callable" title="(in Python v3.6)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><em>Tensor</em></a><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><em>Tensor</em></a><em>]</em><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><em>Tensor</em></a><em>]</em><em>]</em>) – Negative log likelihood (or other proper scoring
function) for use as Laplace approximation</p></li>
<li><p><strong>metric_fns</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Dict" title="(in Python v3.6)"><em>Dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Union" title="(in Python v3.6)"><em>Union</em></a><em>[</em><a class="reference internal" href="hybrid_learning.concepts.train_eval.kpis.aggregating_kpis.AggregatingKpi.html#hybrid_learning.concepts.train_eval.kpis.aggregating_kpis.AggregatingKpi" title="hybrid_learning.concepts.train_eval.kpis.aggregating_kpis.AggregatingKpi"><em>AggregatingKpi</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Callable" title="(in Python v3.6)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><em>Tensor</em></a><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><em>Tensor</em></a><em>]</em><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><em>Tensor</em></a><em>]</em><em>]</em><em>]</em><em>]</em>) – <p>Dictionary of metric functions, each accepting</p>
<ul>
<li><p>the batch model output tensor, and</p></li>
<li><p>the batch ground truth tensor</p></li>
</ul>
<p>and yields the value of the specified metric.</p>
</p></li>
<li><p><strong>model_output_transform</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference internal" href="hybrid_learning.datasets.transforms.tuple_transforms.TupleTransforms.html#hybrid_learning.datasets.transforms.tuple_transforms.TupleTransforms" title="hybrid_learning.datasets.transforms.tuple_transforms.TupleTransforms"><em>TupleTransforms</em></a><em>]</em>) – transformation applied to
the tuples of <code class="docutils literal notranslate"><span class="pre">(model</span> <span class="pre">output,</span> <span class="pre">target)</span></code> before applying loss
functions or metric functions;
the functions are wrapped correspondingly;</p></li>
<li><p><strong>metric_input_transform</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference internal" href="hybrid_learning.datasets.transforms.tuple_transforms.TupleTransforms.html#hybrid_learning.datasets.transforms.tuple_transforms.TupleTransforms" title="hybrid_learning.datasets.transforms.tuple_transforms.TupleTransforms"><em>TupleTransforms</em></a><em>]</em>) – transformation applied to
the tuples of <code class="docutils literal notranslate"><span class="pre">(model</span> <span class="pre">output,</span> <span class="pre">target)</span></code> before applying metric
functions only (not the loss and scoring functions), after
model_output_transform is applied;
the functions are wrapped correspondingly;
meant as convenient way to modify metrics simultaneously</p></li>
<li><p><strong>callbacks</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.List" title="(in Python v3.6)"><em>List</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Mapping" title="(in Python v3.6)"><em>Mapping</em></a><em>[</em><a class="reference internal" href="hybrid_learning.concepts.train_eval.callbacks.CallbackEvents.html#hybrid_learning.concepts.train_eval.callbacks.CallbackEvents" title="hybrid_learning.concepts.train_eval.callbacks.CallbackEvents"><em>CallbackEvents</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Callable" title="(in Python v3.6)"><em>Callable</em></a><em>]</em><em>]</em><em>]</em>) – see <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.callbacks" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.callbacks"><code class="xref py py-attr docutils literal notranslate"><span class="pre">callbacks</span></code></a></p></li>
<li><p><strong>show_progress_bars</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Union" title="(in Python v3.6)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em>]</em>) – see <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.show_progress_bars" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.show_progress_bars"><code class="xref py py-attr docutils literal notranslate"><span class="pre">show_progress_bars</span></code></a></p></li>
<li><p><strong>data</strong> (<a class="reference internal" href="hybrid_learning.datasets.base.DataTriple.html#hybrid_learning.datasets.base.DataTriple" title="hybrid_learning.datasets.base.DataTriple"><em>DataTriple</em></a>) – </p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>]</em>) – </p></li>
<li><p><strong>batch_size_val</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>]</em>) – </p></li>
<li><p><strong>batch_size_hessian</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>]</em>) – </p></li>
<li><p><strong>max_epochs</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>]</em>) – </p></li>
<li><p><strong>callback_context</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Dict" title="(in Python v3.6)"><em>Dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Any" title="(in Python v3.6)"><em>Any</em></a><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.__repr__">
<span class="sig-name descname"><span class="pre">__repr__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/train_eval/base_handles/train_test_handle.html#TrainEvalHandle.__repr__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.__repr__" title="Permalink to this definition"></a></dt>
<dd><p>Return repr(self).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.add_callbacks">
<span class="sig-name descname"><span class="pre">add_callbacks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">callbacks</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/train_eval/base_handles/train_test_handle.html#TrainEvalHandle.add_callbacks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.add_callbacks" title="Permalink to this definition"></a></dt>
<dd><p>Append the given callbacks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>callbacks</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Iterable" title="(in Python v3.6)"><em>Iterable</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Mapping" title="(in Python v3.6)"><em>Mapping</em></a><em>[</em><a class="reference internal" href="hybrid_learning.concepts.train_eval.callbacks.CallbackEvents.html#hybrid_learning.concepts.train_eval.callbacks.CallbackEvents" title="hybrid_learning.concepts.train_eval.callbacks.CallbackEvents"><em>CallbackEvents</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Callable" title="(in Python v3.6)"><em>Callable</em></a><em>]</em><em>]</em>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.cross_validate">
<span class="sig-name descname"><span class="pre">cross_validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_splits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_val_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_info_templ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Run</span> <span class="pre">{run}/{runs}'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pbar_desc_templ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'epoch</span> <span class="pre">{epoch}/{epochs}'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/train_eval/base_handles/train_test_handle.html#TrainEvalHandle.cross_validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.cross_validate" title="Permalink to this definition"></a></dt>
<dd><p>Record training results for <code class="docutils literal notranslate"><span class="pre">num_splits</span></code> distinct val splits.
The original model state dict is restored after training runs.
The model must feature a <code class="docutils literal notranslate"><span class="pre">reset_parameters()</span></code> method to reinitialize
between the runs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>run_info_templ</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – template containing as substring placeholders
<code class="docutils literal notranslate"><span class="pre">{run}</span></code> (the number of the current run) and <code class="docutils literal notranslate"><span class="pre">runs</span></code>
(the total number of runs);
the template is used as prefix for logging and progress bars</p></li>
<li><p><strong>num_splits</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – number of equal-sized, distinct validation splits
to use</p></li>
<li><p><strong>train_val_data</strong> – optional given dataset to split into train and
validation dataset splits; defaults to the <code class="docutils literal notranslate"><span class="pre">train_val</span></code> split in
<a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.data" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code></a></p></li>
<li><p><strong>callback_context</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Dict" title="(in Python v3.6)"><em>Dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Any" title="(in Python v3.6)"><em>Any</em></a><em>]</em><em>]</em>) – current callback context to use;
defaults to copy of <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.callback_context" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.callback_context"><code class="xref py py-attr docutils literal notranslate"><span class="pre">callback_context</span></code></a></p></li>
<li><p><strong>pbar_desc_templ</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – template for progress bar description
(prefixed by run information); see <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.train" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.train"><code class="xref py py-meth docutils literal notranslate"><span class="pre">train()</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>list of tuples of the form</p>
<div class="line-block">
<div class="line">(</div>
<div class="line-block">
<div class="line">final <code class="docutils literal notranslate"><span class="pre">state_dict</span></code>,</div>
<div class="line">epoch- and batch-wise train history as
<code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>,</div>
<div class="line">epoch-wise validation history as <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></div>
</div>
<div class="line">)</div>
</div>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.List" title="(in Python v3.6)"><em>List</em></a>[<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Tuple" title="(in Python v3.6)"><em>Tuple</em></a>[<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Dict" title="(in Python v3.6)"><em>Dict</em></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>, <a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><em>Tensor</em></a>], <em>DataFrame</em>, <em>DataFrame</em>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.detached_state_dict">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">detached_state_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/train_eval/base_handles/train_test_handle.html#TrainEvalHandle.detached_state_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.detached_state_dict" title="Permalink to this definition"></a></dt>
<dd><p>Return a properly detached copy of the state dict of <code class="docutils literal notranslate"><span class="pre">model</span></code>
on <code class="docutils literal notranslate"><span class="pre">device</span></code>.
By default, the copy is created on <code class="docutils literal notranslate"><span class="pre">cpu</span></code> device to avoid
overloading the GPU memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Module</em>) – </p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Union" title="(in Python v3.6)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em>, </em><em>device</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Dict" title="(in Python v3.6)"><em>Dict</em></a>[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>, <a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><em>Tensor</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">DatasetSplit.TEST</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_loader</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pbar_desc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Progress'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/train_eval/base_handles/train_test_handle.html#TrainEvalHandle.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.evaluate" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate the model wrt. <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.settings" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.settings"><code class="xref py py-attr docutils literal notranslate"><span class="pre">settings</span></code></a>.
This is a wrapper around
<a class="reference internal" href="hybrid_learning.concepts.train_eval.train_eval_funs.evaluate.html#hybrid_learning.concepts.train_eval.train_eval_funs.evaluate" title="hybrid_learning.concepts.train_eval.train_eval_funs.evaluate"><code class="xref py py-func docutils literal notranslate"><span class="pre">evaluate()</span></code></a> which
uses the defaults given by <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.settings" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.settings"><code class="xref py py-attr docutils literal notranslate"><span class="pre">settings</span></code></a>.
Override them by specifying them as <code class="docutils literal notranslate"><span class="pre">custom_args</span></code>.
The device used for evaluation is <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.device" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.device"><code class="xref py py-attr docutils literal notranslate"><span class="pre">device</span></code></a> or the one of the
model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Union" title="(in Python v3.6)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em>, </em><a class="reference internal" href="hybrid_learning.datasets.base.DatasetSplit.html#hybrid_learning.datasets.base.DatasetSplit" title="hybrid_learning.datasets.base.DatasetSplit"><em>DatasetSplit</em></a><em>]</em>) – see <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.loader" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.loader"><code class="xref py py-attr docutils literal notranslate"><span class="pre">loader</span></code></a></p></li>
<li><p><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em>]</em>) – see
<a class="reference internal" href="hybrid_learning.concepts.train_eval.train_eval_funs.evaluate.html#hybrid_learning.concepts.train_eval.train_eval_funs.evaluate" title="hybrid_learning.concepts.train_eval.train_eval_funs.evaluate"><code class="xref py py-func docutils literal notranslate"><span class="pre">evaluate()</span></code></a></p></li>
<li><p><strong>val_loader</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference internal" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="torch.utils.data.DataLoader"><code class="docutils literal notranslate"><span class="pre">torch.utils.data.DataLoader</span></code></a><em>]</em>) – the evaluation dataset loader;
defaults to one with <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.data" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code></a> of respective <code class="docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>callback_context</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Dict" title="(in Python v3.6)"><em>Dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Any" title="(in Python v3.6)"><em>Any</em></a><em>]</em><em>]</em>) – see <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.callback_context" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.callback_context"><code class="xref py py-attr docutils literal notranslate"><span class="pre">callback_context</span></code></a></p></li>
<li><p><strong>pbar_desc</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – leading static description text for the progress bar
if newly created</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary of all KPIs, i.e. of <code class="docutils literal notranslate"><span class="pre">loss</span></code> and each metric
in <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.metric_fns" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.metric_fns"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metric_fns</span></code></a>;
format: <code class="docutils literal notranslate"><span class="pre">{&lt;KPI-name&gt;:</span> <span class="pre">&lt;KPI</span> <span class="pre">value</span> <span class="pre">as</span> <span class="pre">float&gt;}</span></code></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><em>Series</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.loader">
<span class="sig-name descname"><span class="pre">loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/train_eval/base_handles/train_test_handle.html#TrainEvalHandle.loader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.loader" title="Permalink to this definition"></a></dt>
<dd><p>Prepare and return a torch data loader from the dataset
according to settings.
For details see <a class="reference internal" href="hybrid_learning.concepts.train_eval.train_eval_funs.loader.html#hybrid_learning.concepts.train_eval.train_eval_funs.loader" title="hybrid_learning.concepts.train_eval.train_eval_funs.loader"><code class="xref py py-meth docutils literal notranslate"><span class="pre">loader()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Union" title="(in Python v3.6)"><em>Union</em></a><em>[</em><a class="reference internal" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset" title="torch.utils.data.Dataset"><code class="docutils literal notranslate"><span class="pre">torch.utils.data.Dataset</span></code></a><em>, </em><a class="reference internal" href="hybrid_learning.datasets.base.BaseDataset.html#hybrid_learning.datasets.base.BaseDataset" title="hybrid_learning.datasets.base.BaseDataset"><em>BaseDataset</em></a><em>]</em><em>]</em>) – data to obtain loader for; defaults to
<a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.data" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code></a> of respective <code class="docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Union" title="(in Python v3.6)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em>, </em><a class="reference internal" href="hybrid_learning.datasets.base.DatasetSplit.html#hybrid_learning.datasets.base.DatasetSplit" title="hybrid_learning.datasets.base.DatasetSplit"><em>DatasetSplit</em></a><em>]</em><em>]</em>) – which <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.data" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code></a> split to use by default;
specify as instance of
<a class="reference internal" href="hybrid_learning.datasets.base.DatasetSplit.html#hybrid_learning.datasets.base.DatasetSplit" title="hybrid_learning.datasets.base.DatasetSplit"><code class="xref py py-class docutils literal notranslate"><span class="pre">DatasetSplit</span></code></a>
or the name of one;</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>]</em>) – defaults to <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.batch_size" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.batch_size"><code class="xref py py-attr docutils literal notranslate"><span class="pre">batch_size</span></code></a></p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><em>device</em><em>]</em>) – defaults to <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.device" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.device"><code class="xref py py-attr docutils literal notranslate"><span class="pre">device</span></code></a></p></li>
<li><p><strong>num_workers</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>]</em>) – defaults to <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.num_workers" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.num_workers"><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_workers</span></code></a></p></li>
<li><p><strong>shuffle</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – </p></li>
<li><p><strong>model</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><em>Module</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="torch.utils.data.DataLoader"><code class="docutils literal notranslate"><span class="pre">torch.utils.data.DataLoader</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.prefix_by">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prefix_by</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/train_eval/base_handles/train_test_handle.html#TrainEvalHandle.prefix_by"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.prefix_by" title="Permalink to this definition"></a></dt>
<dd><p>Prefix <code class="docutils literal notranslate"><span class="pre">s</span></code> with the given mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> (<a class="reference internal" href="hybrid_learning.datasets.base.DatasetSplit.html#hybrid_learning.datasets.base.DatasetSplit" title="hybrid_learning.datasets.base.DatasetSplit"><em>DatasetSplit</em></a>) – </p></li>
<li><p><strong>text</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.remove_callback">
<span class="sig-name descname"><span class="pre">remove_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">callback</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/train_eval/base_handles/train_test_handle.html#TrainEvalHandle.remove_callback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.remove_callback" title="Permalink to this definition"></a></dt>
<dd><p>Remove a single given callback.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>callback</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Callable" title="(in Python v3.6)"><em>Callable</em></a>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.reset_kpis">
<span class="sig-name descname"><span class="pre">reset_kpis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/train_eval/base_handles/train_test_handle.html#TrainEvalHandle.reset_kpis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.reset_kpis" title="Permalink to this definition"></a></dt>
<dd><p>Resets aggregating kpis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kpis</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Dict" title="(in Python v3.6)"><em>Dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Union" title="(in Python v3.6)"><em>Union</em></a><em>[</em><a class="reference internal" href="hybrid_learning.concepts.train_eval.kpis.aggregating_kpis.AggregatingKpi.html#hybrid_learning.concepts.train_eval.kpis.aggregating_kpis.AggregatingKpi" title="hybrid_learning.concepts.train_eval.kpis.aggregating_kpis.AggregatingKpi"><em>AggregatingKpi</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Callable" title="(in Python v3.6)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><em>Tensor</em></a><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><em>Tensor</em></a><em>]</em><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><em>Tensor</em></a><em>]</em><em>]</em><em>]</em><em>]</em>) – All metric functions and classes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.reset_optimizer">
<span class="sig-name descname"><span class="pre">reset_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/train_eval/base_handles/train_test_handle.html#TrainEvalHandle.reset_optimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.reset_optimizer" title="Permalink to this definition"></a></dt>
<dd><p>Move model to correct device, init optimizer to parameters of model.
By default apply to <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.optimizer" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.optimizer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">optimizer</span></code></a>, <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.device" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.device"><code class="xref py py-attr docutils literal notranslate"><span class="pre">device</span></code></a>,
<a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.model" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.model"><code class="xref py py-attr docutils literal notranslate"><span class="pre">model</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optimizer</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference internal" href="hybrid_learning.concepts.train_eval.base_handles.resettable_optimizer.ResettableOptimizer.html#hybrid_learning.concepts.train_eval.base_handles.resettable_optimizer.ResettableOptimizer" title="hybrid_learning.concepts.train_eval.base_handles.resettable_optimizer.ResettableOptimizer"><em>ResettableOptimizer</em></a><em>]</em>) – </p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><em>device</em><em>]</em>) – </p></li>
<li><p><strong>model</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><em>Module</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.reset_training_handles">
<span class="sig-name descname"><span class="pre">reset_training_handles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/train_eval/base_handles/train_test_handle.html#TrainEvalHandle.reset_training_handles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.reset_training_handles" title="Permalink to this definition"></a></dt>
<dd><p>(Re)set all handles associated with training, and move to <code class="docutils literal notranslate"><span class="pre">device</span></code>.
These are: <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.optimizer" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.optimizer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">optimizer</span></code></a>, <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.early_stopping_handle" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.early_stopping_handle"><code class="xref py py-attr docutils literal notranslate"><span class="pre">early_stopping_handle</span></code></a>,
and the data loaders.
The argument values default to the corresponding attributes of this
instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optimizer</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference internal" href="hybrid_learning.concepts.train_eval.base_handles.resettable_optimizer.ResettableOptimizer.html#hybrid_learning.concepts.train_eval.base_handles.resettable_optimizer.ResettableOptimizer" title="hybrid_learning.concepts.train_eval.base_handles.resettable_optimizer.ResettableOptimizer"><em>ResettableOptimizer</em></a><em>]</em>) – </p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><em>device</em><em>]</em>) – </p></li>
<li><p><strong>model</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><em>Module</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.second_stage_train">
<span class="sig-name descname"><span class="pre">second_stage_train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">callback_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/train_eval/base_handles/train_test_handle.html#TrainEvalHandle.second_stage_train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.second_stage_train" title="Permalink to this definition"></a></dt>
<dd><p>Do a second stage training for calibration using Laplace
approximation. This is a wrapper around
<a class="reference internal" href="hybrid_learning.concepts.train_eval.train_eval_funs.second_stage_train.html#hybrid_learning.concepts.train_eval.train_eval_funs.second_stage_train" title="hybrid_learning.concepts.train_eval.train_eval_funs.second_stage_train"><code class="xref py py-func docutils literal notranslate"><span class="pre">hybrid_learning.concepts.train_eval.train_eval_funs.second_stage_train()</span></code></a>
that uses defaults from <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.settings" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.settings"><code class="xref py py-attr docutils literal notranslate"><span class="pre">settings</span></code></a>.
Before and after the second stage training process one epoch
on the test and the validation set to enable logging of metrics
for comparison.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Evaluation runs on validation and test split are conducted
before (epoch 0) and after (epoch 1) the second stage training.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>callback_context</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Dict" title="(in Python v3.6)"><em>Dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Any" title="(in Python v3.6)"><em>Any</em></a><em>]</em><em>]</em>) – see <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.callback_context" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.callback_context"><code class="xref py py-attr docutils literal notranslate"><span class="pre">callback_context</span></code></a>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>py:class:<cite>pandas.Series</cite> with the final evaluation results
on validation and test splits of <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.data" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code></a></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><em>Series</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.test_">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">test_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/train_eval/base_handles/train_test_handle.html#TrainEvalHandle.test_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.test_" title="Permalink to this definition"></a></dt>
<dd><p>Get name of metric for testing results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>metric_name</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_loader</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_loader</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pbar_desc_templ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Epoch</span> <span class="pre">{epoch}/{epochs}'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/train_eval/base_handles/train_test_handle.html#TrainEvalHandle.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.train" title="Permalink to this definition"></a></dt>
<dd><p>Train the model according to the specified training parameters.
Defaults are taken from <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.settings" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.settings"><code class="xref py py-attr docutils literal notranslate"><span class="pre">settings</span></code></a>.
To override specify <code class="docutils literal notranslate"><span class="pre">custom_args</span></code> (compare arguments to
<a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.train_val_one_epoch" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.train_val_one_epoch"><code class="xref py py-attr docutils literal notranslate"><span class="pre">train_val_one_epoch</span></code></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>callback_context</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Dict" title="(in Python v3.6)"><em>Dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Any" title="(in Python v3.6)"><em>Any</em></a><em>]</em><em>]</em>) – see <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.callback_context" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.callback_context"><code class="xref py py-attr docutils literal notranslate"><span class="pre">callback_context</span></code></a></p></li>
<li><p><strong>pbar_desc_templ</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – <p>template for the progress bar description;
must accept as substring</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">{epoch}</span></code>: the current epoch number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{tot_epoch}</span></code>: the total number of epochs</p></li>
</ul>
</p></li>
<li><p><strong>train_loader</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference internal" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="torch.utils.data.DataLoader"><code class="docutils literal notranslate"><span class="pre">torch.utils.data.DataLoader</span></code></a><em>]</em>) – see <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.train_one_epoch" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.train_one_epoch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">train_one_epoch()</span></code></a></p></li>
<li><p><strong>val_loader</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference internal" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="torch.utils.data.DataLoader"><code class="docutils literal notranslate"><span class="pre">torch.utils.data.DataLoader</span></code></a><em>]</em>) – see <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.evaluate" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.evaluate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">evaluate()</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Two <cite>pandas.DataFrame</cite> with history information on</p>
<ul class="simple">
<li><p><em>training</em>: the epoch- and batch-wise loss and KPI results on the
training data,
index is a multi-index of <code class="docutils literal notranslate"><span class="pre">(epoch,</span> <span class="pre">batch)</span></code>;</p></li>
<li><p><em>test</em>: the epoch-wise evaluation results on the test set;
index is the epoch index;</p></li>
</ul>
<p>columns for both are <code class="docutils literal notranslate"><span class="pre">loss</span></code> and KPI names
(keys of <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.metric_fns" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.metric_fns"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metric_fns</span></code></a>)</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Tuple" title="(in Python v3.6)"><em>Tuple</em></a>[<em>DataFrame</em>, <em>DataFrame</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.train_">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">train_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/train_eval/base_handles/train_test_handle.html#TrainEvalHandle.train_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.train_" title="Permalink to this definition"></a></dt>
<dd><p>Get name of metric for training results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>metric_name</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.train_one_epoch">
<span class="sig-name descname"><span class="pre">train_one_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_loader</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pbar_desc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Train</span> <span class="pre">progress'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/train_eval/base_handles/train_test_handle.html#TrainEvalHandle.train_one_epoch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.train_one_epoch" title="Permalink to this definition"></a></dt>
<dd><p>Train for one epoch and return history results as
<code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>.
This is a wrapper around
<a class="reference internal" href="hybrid_learning.concepts.train_eval.train_eval_funs.train_one_epoch.html#hybrid_learning.concepts.train_eval.train_eval_funs.train_one_epoch" title="hybrid_learning.concepts.train_eval.train_eval_funs.train_one_epoch"><code class="xref py py-func docutils literal notranslate"><span class="pre">hybrid_learning.concepts.train_eval.train_eval_funs.train_one_epoch()</span></code></a>
that uses defaults from <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.settings" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.settings"><code class="xref py py-attr docutils literal notranslate"><span class="pre">settings</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_loader</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference internal" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="torch.utils.data.DataLoader"><code class="docutils literal notranslate"><span class="pre">torch.utils.data.DataLoader</span></code></a><em>]</em>) – the training loader to use;
defaults to a shuffled one with training <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.data" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code></a> of <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
<li><p><strong>callback_context</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Dict" title="(in Python v3.6)"><em>Dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Any" title="(in Python v3.6)"><em>Any</em></a><em>]</em><em>]</em>) – see <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.callback_context" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.callback_context"><code class="xref py py-attr docutils literal notranslate"><span class="pre">callback_context</span></code></a></p></li>
<li><p><strong>pbar_desc</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – leading static description text for the progress bar
if newly created</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>tuple of training history and test results as
<code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> with:</p>
<dl class="field-list simple">
<dt class="field-odd">columns</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">loss</span></code> and the KPI names
(keys from dict <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.metric_fns" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.metric_fns"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metric_fns</span></code></a>),</p>
</dd>
<dt class="field-even">index</dt>
<dd class="field-even"><p>the batch indices,</p>
</dd>
<dt class="field-odd">items</dt>
<dd class="field-odd"><p>the results of KPI evaluations of the output on the training
batch (i.e. <em>before</em> back-propagation step)</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><em>DataFrame</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.train_val_one_epoch">
<span class="sig-name descname"><span class="pre">train_val_one_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pbar_desc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_loader</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_loader</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/train_eval/base_handles/train_test_handle.html#TrainEvalHandle.train_val_one_epoch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.train_val_one_epoch" title="Permalink to this definition"></a></dt>
<dd><p>Train for one epoch, evaluate, and return history and test results.
This is a wrapper around <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.train_one_epoch" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.train_one_epoch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">train_one_epoch()</span></code></a> and
<a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.evaluate" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.evaluate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">evaluate()</span></code></a> with nice progress bar printing and logging after
the epoch.
History and test results are stored in a <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>.
The device used for training is that of the parameters of the used
model (see <a class="reference internal" href="hybrid_learning.concepts.train_eval.train_eval_funs.device_of.html#hybrid_learning.concepts.train_eval.train_eval_funs.device_of" title="hybrid_learning.concepts.train_eval.train_eval_funs.device_of"><code class="xref py py-func docutils literal notranslate"><span class="pre">device_of()</span></code></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pbar_desc</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em>]</em>) – leading static description text for the progress bar</p></li>
<li><p><strong>callback_context</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Dict" title="(in Python v3.6)"><em>Dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Any" title="(in Python v3.6)"><em>Any</em></a><em>]</em><em>]</em>) – see <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.callback_context" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.callback_context"><code class="xref py py-attr docutils literal notranslate"><span class="pre">callback_context</span></code></a></p></li>
<li><p><strong>train_loader</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference internal" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="torch.utils.data.DataLoader"><code class="docutils literal notranslate"><span class="pre">torch.utils.data.DataLoader</span></code></a><em>]</em>) – see <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.train_one_epoch" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.train_one_epoch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">train_one_epoch()</span></code></a></p></li>
<li><p><strong>val_loader</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Optional" title="(in Python v3.6)"><em>Optional</em></a><em>[</em><a class="reference internal" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="torch.utils.data.DataLoader"><code class="docutils literal notranslate"><span class="pre">torch.utils.data.DataLoader</span></code></a><em>]</em>) – see <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.evaluate" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.evaluate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">evaluate()</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>tuple of training history and test results; columns resp.
index are <code class="docutils literal notranslate"><span class="pre">loss</span></code> and the KPI names
(keys from dict <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.metric_fns" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.metric_fns"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metric_fns</span></code></a>).</p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>: index are the batch indices,
items are the results of KPI evaluations of the output on the
training batch (i.e. before back-propagation step)</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.Series</span></code>: the items are the final evaluations of
the KPIs on the validation set</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.6/library/typing.html#typing.Tuple" title="(in Python v3.6)"><em>Tuple</em></a>[<em>DataFrame</em>, <em>Series</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.val_">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">val_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/train_eval/base_handles/train_test_handle.html#TrainEvalHandle.val_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.val_" title="Permalink to this definition"></a></dt>
<dd><p>Get name of metric for validation results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>metric_name</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.LOSS_KEY">
<span class="sig-name descname"><span class="pre">LOSS_KEY</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'loss'</span></em><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.LOSS_KEY" title="Permalink to this definition"></a></dt>
<dd><p>Key for the loss evaluation results.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.NLL_KEY">
<span class="sig-name descname"><span class="pre">NLL_KEY</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'NLL'</span></em><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.NLL_KEY" title="Permalink to this definition"></a></dt>
<dd><p>Key for the proper scoring evaluation function used for second stage
training. Typically a negative log-likelihood.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.batch_size">
<span class="sig-name descname"><span class="pre">batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><span class="pre">int</span></a></em><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.batch_size" title="Permalink to this definition"></a></dt>
<dd><p>Default training batch size.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.batch_size_hessian">
<span class="sig-name descname"><span class="pre">batch_size_hessian</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><span class="pre">int</span></a></em><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.batch_size_hessian" title="Permalink to this definition"></a></dt>
<dd><p>Default batch size for calculating the hessian.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.batch_size_val">
<span class="sig-name descname"><span class="pre">batch_size_val</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><span class="pre">int</span></a></em><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.batch_size_val" title="Permalink to this definition"></a></dt>
<dd><p>Default validation batch size.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.callback_context">
<span class="sig-name descname"><span class="pre">callback_context</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.callback_context" title="Permalink to this definition"></a></dt>
<dd><p>The default callback context values to use.
In any training run where context is used, the context can either be
handed over or it defaults to a copy of this dict.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.callbacks">
<span class="sig-name descname"><span class="pre">callbacks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="hybrid_learning.concepts.train_eval.callbacks.CallbackEvents.html#hybrid_learning.concepts.train_eval.callbacks.CallbackEvents" title="hybrid_learning.concepts.train_eval.callbacks.CallbackEvents"><span class="pre">CallbackEvents</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.callbacks" title="Permalink to this definition"></a></dt>
<dd><p>A dictionary mapping events to a list of callables that are called
every time the event occurs with the current state.
Some default logging callbacks are defined.</p>
<p>For details on available events, see
<a class="reference internal" href="hybrid_learning.concepts.train_eval.callbacks.CallbackEvents.html#hybrid_learning.concepts.train_eval.callbacks.CallbackEvents" title="hybrid_learning.concepts.train_eval.callbacks.CallbackEvents"><code class="xref py py-class docutils literal notranslate"><span class="pre">hybrid_learning.concepts.train_eval.callbacks.CallbackEvents</span></code></a>.
After the event, all callbacks for this event are called in order
with keyword arguments from a
<a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.callback_context" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.callback_context"><code class="xref py py-attr docutils literal notranslate"><span class="pre">hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.callback_context</span></code></a>.
The base context is dependent on the event and includes e.g. the model,
and can be extended by specifying the callback context during
function call or in the default callback context.
Note that side effects on objects in the callback context (e.g. the
model) will influence the training.
Callback application examples:</p>
<ul class="simple">
<li><p>Logging</p></li>
<li><p>Storing of best n models</p></li>
<li><p>Results saving, e.g. to tensorboard or sacred log</p></li>
<li><p>Forced weight normalization</p></li>
</ul>
<p>Callbacks can be
<a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.add_callbacks" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.add_callbacks"><code class="xref py py-meth docutils literal notranslate"><span class="pre">added</span></code></a>
and
<a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.remove_callback" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.remove_callback"><code class="xref py py-meth docutils literal notranslate"><span class="pre">removed</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.data">
<span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="hybrid_learning.datasets.base.DataTriple.html#hybrid_learning.datasets.base.DataTriple" title="hybrid_learning.datasets.base.DataTriple"><span class="pre">DataTriple</span></a></em><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.data" title="Permalink to this definition"></a></dt>
<dd><p>Train, validation, and test data splits to use.
Must be converted to data loaders before usage.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.device">
<span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.device</span></em><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.device" title="Permalink to this definition"></a></dt>
<dd><p>Device to run training and testing on (this is where the data
loaders are put).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.early_stopping_handle">
<span class="sig-name descname"><span class="pre">early_stopping_handle</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="hybrid_learning.concepts.train_eval.base_handles.early_stopping.EarlyStoppingHandle.html#hybrid_learning.concepts.train_eval.base_handles.early_stopping.EarlyStoppingHandle" title="hybrid_learning.concepts.train_eval.base_handles.early_stopping.EarlyStoppingHandle"><span class="pre">EarlyStoppingHandle</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.early_stopping_handle" title="Permalink to this definition"></a></dt>
<dd><p>Handle that is stepped during training and indicates need for
early stopping.
To disable early stopping, set <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.early_stopping_handle" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.early_stopping_handle"><code class="xref py py-attr docutils literal notranslate"><span class="pre">early_stopping_handle</span></code></a> to
<code class="docutils literal notranslate"><span class="pre">None</span></code> resp. specify <code class="docutils literal notranslate"><span class="pre">early_stopping_handle=False</span></code> in
<code class="docutils literal notranslate"><span class="pre">__init__</span></code> arguments.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.epochs">
<span class="sig-name descname"><span class="pre">epochs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><span class="pre">int</span></a></em><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.epochs" title="Permalink to this definition"></a></dt>
<dd><p>Default maximum number of epochs.
May be reduced by <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.early_stopping_handle" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.early_stopping_handle"><code class="xref py py-attr docutils literal notranslate"><span class="pre">early_stopping_handle</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.kpi_fns">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kpi_fns</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.kpi_fns" title="Permalink to this definition"></a></dt>
<dd><p>Metric <em>and</em> loss functions.
Nomenclature: <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.metric_fns" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.metric_fns"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metric_fns</span></code></a> holds all metrics meant for
evaluation, while <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.kpi_fns" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.kpi_fns"><code class="xref py py-attr docutils literal notranslate"><span class="pre">kpi_fns</span></code></a> also encompasses the losses.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.loss_fn">
<span class="sig-name descname"><span class="pre">loss_fn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.loss_fn" title="Permalink to this definition"></a></dt>
<dd><p>Loss function callable.
Defaults to a balanced binary cross-entropy assuming on average 1%
positive px per img.
Must be wrapped into a tuple to hide the parameters, since these are
not to be updated.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.metric_fns">
<span class="sig-name descname"><span class="pre">metric_fns</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="hybrid_learning.concepts.train_eval.kpis.aggregating_kpis.AggregatingKpi.html#hybrid_learning.concepts.train_eval.kpis.aggregating_kpis.AggregatingKpi" title="hybrid_learning.concepts.train_eval.kpis.aggregating_kpis.AggregatingKpi"><span class="pre">AggregatingKpi</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.metric_fns" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary of metric functions to apply for evaluation and logging.
Each function must have a signature of
<code class="docutils literal notranslate"><span class="pre">(output,</span> <span class="pre">target)</span> <span class="pre">-&gt;</span> <span class="pre">metric_value</span></code>. See also <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.kpi_fns" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.kpi_fns"><code class="xref py py-attr docutils literal notranslate"><span class="pre">kpi_fns</span></code></a>.
Keys must not contain <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.LOSS_KEY" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.LOSS_KEY"><code class="xref py py-const docutils literal notranslate"><span class="pre">LOSS_KEY</span></code></a> or <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.NLL_KEY" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.NLL_KEY"><code class="xref py py-const docutils literal notranslate"><span class="pre">NLL_KEY</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.model">
<span class="sig-name descname"><span class="pre">model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.nn.modules.module.Module</span></em><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.model" title="Permalink to this definition"></a></dt>
<dd><p>The model to work on.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.nll_fn">
<span class="sig-name descname"><span class="pre">nll_fn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.nll_fn" title="Permalink to this definition"></a></dt>
<dd><p>Proper scoring function callable used as loss in second stage
training for Laplace approximation.
Usually is chosen as negative log-likelihood, defaults to
<a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.loss_fn" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.loss_fn"><code class="xref py py-attr docutils literal notranslate"><span class="pre">loss_fn</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.num_workers">
<span class="sig-name descname"><span class="pre">num_workers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><span class="pre">int</span></a></em><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.num_workers" title="Permalink to this definition"></a></dt>
<dd><p>The default number of workers to use for data loading.
See <a class="reference internal" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.loader" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.loader"><code class="xref py py-meth docutils literal notranslate"><span class="pre">hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.loader()</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.optimizer">
<span class="sig-name descname"><span class="pre">optimizer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="hybrid_learning.concepts.train_eval.base_handles.resettable_optimizer.ResettableOptimizer.html#hybrid_learning.concepts.train_eval.base_handles.resettable_optimizer.ResettableOptimizer" title="hybrid_learning.concepts.train_eval.base_handles.resettable_optimizer.ResettableOptimizer"><span class="pre">ResettableOptimizer</span></a></em><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.optimizer" title="Permalink to this definition"></a></dt>
<dd><p>Optimizer and learning rate scheduler handle.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.settings">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">settings</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.settings" title="Permalink to this definition"></a></dt>
<dd><p>The current training settings as dictionary.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.show_progress_bars">
<span class="sig-name descname"><span class="pre">show_progress_bars</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><span class="pre">str</span></a></em><a class="headerlink" href="#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.show_progress_bars" title="Permalink to this definition"></a></dt>
<dd><p>Whether to show progress bars for batch-wise operations.
Value must be a comma-separated concatenation of run types
(the values of dataset splits) for which to show progress,
or <code class="docutils literal notranslate"><span class="pre">'always'</span></code>.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.html" class="btn btn-neutral float-left" title="train_test_handle" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="hybrid_learning.concepts.train_eval.callbacks.html" class="btn btn-neutral float-right" title="callbacks" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Continental Automotive GmbH.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>