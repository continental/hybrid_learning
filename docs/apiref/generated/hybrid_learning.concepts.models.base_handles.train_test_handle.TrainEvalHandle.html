

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>TrainEvalHandle &mdash; hybrid_learning  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/autoclasstoc.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="concept_detection" href="hybrid_learning.concepts.models.concept_detection.html" />
    <link rel="prev" title="train_test_handle" href="hybrid_learning.concepts.models.base_handles.train_test_handle.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> hybrid_learning
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Content</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/index.html">Quickstart Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../userguide/index.html">User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="hybrid_learning.concepts.html">concepts</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="hybrid_learning.concepts.analysis.html">analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="hybrid_learning.concepts.concepts.html">concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="hybrid_learning.concepts.embeddings.html">embeddings</a></li>
<li class="toctree-l3"><a class="reference internal" href="hybrid_learning.concepts.enforcement.html">enforcement</a></li>
<li class="toctree-l3"><a class="reference internal" href="hybrid_learning.concepts.kpis.html">kpis</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="hybrid_learning.concepts.models.html">models</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="hybrid_learning.concepts.models.base_handles.html">base_handles</a></li>
<li class="toctree-l4"><a class="reference internal" href="hybrid_learning.concepts.models.concept_detection.html">concept_detection</a></li>
<li class="toctree-l4"><a class="reference internal" href="hybrid_learning.concepts.models.concept_segmentation.html">concept_segmentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="hybrid_learning.concepts.models.model_extension.html">model_extension</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hybrid_learning.concepts.visualization.html">visualization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="hybrid_learning.datasets.html">datasets</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">How to contribute</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">hybrid_learning</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">API Reference</a> &raquo;</li>
        
          <li><a href="hybrid_learning.concepts.html">concepts</a> &raquo;</li>
        
          <li><a href="hybrid_learning.concepts.models.html">models</a> &raquo;</li>
        
          <li><a href="hybrid_learning.concepts.models.base_handles.html">base_handles</a> &raquo;</li>
        
          <li><a href="hybrid_learning.concepts.models.base_handles.train_test_handle.html">train_test_handle</a> &raquo;</li>
        
      <li>TrainEvalHandle</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/apiref/generated/hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="trainevalhandle">
<h1>TrainEvalHandle<a class="headerlink" href="#trainevalhandle" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle">
<em class="property">class </em><code class="sig-prename descclassname">hybrid_learning.concepts.models.base_handles.train_test_handle.</code><code class="sig-name descname">TrainEvalHandle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">device</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_epochs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">loss_fn</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">metric_fns</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">early_stopping_handle</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">optimizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">model_output_transform</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/models/base_handles/train_test_handle.html#TrainEvalHandle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.6/library/abc.html#abc.ABC" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></a></p>
<p>Handle for training and evaluation of pytorch models.
The model base class should be <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch vmaster (1.6.0a0+4392e52 ))"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></a>.</p>
<p>The main functions are <a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.train" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.train"><code class="xref py py-meth docutils literal notranslate"><span class="pre">train()</span></code></a> and <a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.evaluate" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.evaluate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">evaluate()</span></code></a>.
Metrics and loss functions must be given on initialization.
Training and evaluation results are returned as
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> resp. <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.Series</span></code></a> with columns
the metric keys (prefixed according to the mode).
Modes can be train, test, or validation (see instances of
<a class="reference internal" href="hybrid_learning.datasets.base.DatasetSplit.html#hybrid_learning.datasets.base.DatasetSplit" title="hybrid_learning.datasets.base.DatasetSplit"><code class="xref py py-class docutils literal notranslate"><span class="pre">DatasetSplit</span></code></a> enum).
The non-prefixed loss key is saved in <a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.LOSS_KEY" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.LOSS_KEY"><code class="xref py py-const docutils literal notranslate"><span class="pre">LOSS_KEY</span></code></a>.</p>
<p>For a usage example see
<a class="reference internal" href="hybrid_learning.concepts.models.concept_detection.ConceptDetection2DTrainTestHandle.html#hybrid_learning.concepts.models.concept_detection.ConceptDetection2DTrainTestHandle" title="hybrid_learning.concepts.models.concept_detection.ConceptDetection2DTrainTestHandle"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConceptDetection2DTrainTestHandle</span></code></a>.</p>
<p>Init.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.modules.module.Module</em>) – model to train/eval</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – device on which to load the data and the model parameters</p></li>
<li><p><strong>optimizer</strong> (<em>Callable</em><em>[</em><em>..</em><em>, </em><em>torch.optim.optimizer.Optimizer</em><em>]</em>) – callable that yields a fresh optimizer instance
when called on the model’s trainable parameters</p></li>
<li><p><strong>early_stopping_handle</strong> (<a class="reference internal" href="hybrid_learning.concepts.models.base_handles.early_stopping.EarlyStoppingHandle.html#hybrid_learning.concepts.models.base_handles.early_stopping.EarlyStoppingHandle" title="hybrid_learning.concepts.models.base_handles.early_stopping.EarlyStoppingHandle"><em>hybrid_learning.concepts.models.base_handles.early_stopping.EarlyStoppingHandle</em></a>) – handle for early stopping;
defaults to default
<a class="reference internal" href="hybrid_learning.concepts.models.base_handles.early_stopping.EarlyStoppingHandle.html#hybrid_learning.concepts.models.base_handles.early_stopping.EarlyStoppingHandle" title="hybrid_learning.concepts.models.base_handles.early_stopping.EarlyStoppingHandle"><code class="xref py py-class docutils literal notranslate"><span class="pre">EarlyStoppingHandle</span></code></a>
if <code class="docutils literal notranslate"><span class="pre">None</span></code>; set to <code class="docutils literal notranslate"><span class="pre">False</span></code> to disable early stopping;</p></li>
<li><p><strong>loss_fn</strong> (<em>Callable</em><em>[</em><em>[</em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.6.0a0+4392e52 ))"><em>torch.Tensor</em></a><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.6.0a0+4392e52 ))"><em>torch.Tensor</em></a><em>]</em><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.6.0a0+4392e52 ))"><em>torch.Tensor</em></a><em>]</em>) – differentiable metric function to use as loss</p></li>
<li><p><strong>metric_fns</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em>, </em><em>Callable</em><em>[</em><em>[</em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.6.0a0+4392e52 ))"><em>torch.Tensor</em></a><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.6.0a0+4392e52 ))"><em>torch.Tensor</em></a><em>]</em><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.6.0a0+4392e52 ))"><em>torch.Tensor</em></a><em>]</em><em>]</em>) – <p>Dictionary of metric functions, each accepting</p>
<ul>
<li><p>the batch model output tensor, and</p></li>
<li><p>the batch ground truth tensor</p></li>
</ul>
<p>and yields the value of the specified metric.</p>
</p></li>
<li><p><strong>model_output_transform</strong> (<a class="reference internal" href="hybrid_learning.datasets.transforms.tuple_transforms.TupleTransforms.html#hybrid_learning.datasets.transforms.tuple_transforms.TupleTransforms" title="hybrid_learning.datasets.transforms.tuple_transforms.TupleTransforms"><em>hybrid_learning.datasets.transforms.tuple_transforms.TupleTransforms</em></a>) – transformation applied to the tuples of
<code class="docutils literal notranslate"><span class="pre">(model</span> <span class="pre">output,</span> <span class="pre">target)</span></code> before applying loss functions or
metric functions;
the functions are wrapped correspondingly</p></li>
<li><p><strong>data</strong> (<a class="reference internal" href="hybrid_learning.datasets.base.DataTriple.html#hybrid_learning.datasets.base.DataTriple" title="hybrid_learning.datasets.base.DataTriple"><em>hybrid_learning.datasets.base.DataTriple</em></a>) – </p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – </p></li>
<li><p><strong>max_epochs</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – </p></li>
</ul>
</dd>
</dl>
<div class="autoclasstoc docutils container">
<p class="rubric">Public Data Attributes:</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.LOSS_KEY" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.LOSS_KEY"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LOSS_KEY</span></code></a></p></td>
<td><p>Key for the loss evaluation results.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.settings" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.settings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">settings</span></code></a></p></td>
<td><p>The current training settings as dictionary.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="autoclasstoc docutils container">
<p class="rubric">Public Methods:</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.loader" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.loader"><code class="xref py py-obj docutils literal notranslate"><span class="pre">loader</span></code></a>(data[, batch_size, shuffle, device])</p></td>
<td><p>Prepare and return a torch data loader from the dataset according to settings.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.train_loader" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.train_loader"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_loader</span></code></a>([device, batch_size])</p></td>
<td><p>Return a loader for the train data with default settings.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.disable_early_stopping" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.disable_early_stopping"><code class="xref py py-obj docutils literal notranslate"><span class="pre">disable_early_stopping</span></code></a>()</p></td>
<td><p>Disable early stopping.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.reset_optimizer" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.reset_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset_optimizer</span></code></a>([optimizer, device, model])</p></td>
<td><p>Move model to correct device, init optimizer to parameters of model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.reset_training_handles" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.reset_training_handles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset_training_handles</span></code></a>([optimizer, device, …])</p></td>
<td><p>(Re)set all handles associated with training, and move to <code class="docutils literal notranslate"><span class="pre">device</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.train" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a>([epochs, early_stopping_handle, …])</p></td>
<td><p>Train the model according to the specified training parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.cross_validate" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.cross_validate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cross_validate</span></code></a>([num_splits, train_val_data, …])</p></td>
<td><p>Record training results for <code class="docutils literal notranslate"><span class="pre">num_splits</span></code> distinct val splits.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.assess_learning_rates" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.assess_learning_rates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">assess_learning_rates</span></code></a>([min_lr, max_lr, …])</p></td>
<td><p>Collect mean and std deviation of loss for lr candidates via cross-validation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.train_val_one_epoch" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.train_val_one_epoch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_val_one_epoch</span></code></a>([show_progress_bar, …])</p></td>
<td><p>Train for one epoch, evaluate, and return history and test results.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.train_one_epoch" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.train_one_epoch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_one_epoch</span></code></a>([show_progress_bar, pbar, …])</p></td>
<td><p>Train for one epoch and return history results as <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.evaluate" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a>([mode, batch_size])</p></td>
<td><p>Evaluate the model wrt.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="autoclasstoc docutils container">
<p class="rubric">Special Methods:</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.__init__" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(model, data[, device, batch_size, …])</p></td>
<td><p>Init.</p></td>
</tr>
</tbody>
</table>
</div>
<hr class="docutils" />
<dl class="py method">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">device</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_epochs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">loss_fn</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">metric_fns</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">early_stopping_handle</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">optimizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">model_output_transform</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/models/base_handles/train_test_handle.html#TrainEvalHandle.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Init.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.modules.module.Module</em>) – model to train/eval</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – device on which to load the data and the model parameters</p></li>
<li><p><strong>optimizer</strong> (<em>Callable</em><em>[</em><em>..</em><em>, </em><em>torch.optim.optimizer.Optimizer</em><em>]</em>) – callable that yields a fresh optimizer instance
when called on the model’s trainable parameters</p></li>
<li><p><strong>early_stopping_handle</strong> (<a class="reference internal" href="hybrid_learning.concepts.models.base_handles.early_stopping.EarlyStoppingHandle.html#hybrid_learning.concepts.models.base_handles.early_stopping.EarlyStoppingHandle" title="hybrid_learning.concepts.models.base_handles.early_stopping.EarlyStoppingHandle"><em>hybrid_learning.concepts.models.base_handles.early_stopping.EarlyStoppingHandle</em></a>) – handle for early stopping;
defaults to default
<a class="reference internal" href="hybrid_learning.concepts.models.base_handles.early_stopping.EarlyStoppingHandle.html#hybrid_learning.concepts.models.base_handles.early_stopping.EarlyStoppingHandle" title="hybrid_learning.concepts.models.base_handles.early_stopping.EarlyStoppingHandle"><code class="xref py py-class docutils literal notranslate"><span class="pre">EarlyStoppingHandle</span></code></a>
if <code class="docutils literal notranslate"><span class="pre">None</span></code>; set to <code class="docutils literal notranslate"><span class="pre">False</span></code> to disable early stopping;</p></li>
<li><p><strong>loss_fn</strong> (<em>Callable</em><em>[</em><em>[</em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.6.0a0+4392e52 ))"><em>torch.Tensor</em></a><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.6.0a0+4392e52 ))"><em>torch.Tensor</em></a><em>]</em><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.6.0a0+4392e52 ))"><em>torch.Tensor</em></a><em>]</em>) – differentiable metric function to use as loss</p></li>
<li><p><strong>metric_fns</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em>, </em><em>Callable</em><em>[</em><em>[</em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.6.0a0+4392e52 ))"><em>torch.Tensor</em></a><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.6.0a0+4392e52 ))"><em>torch.Tensor</em></a><em>]</em><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.6.0a0+4392e52 ))"><em>torch.Tensor</em></a><em>]</em><em>]</em>) – <p>Dictionary of metric functions, each accepting</p>
<ul>
<li><p>the batch model output tensor, and</p></li>
<li><p>the batch ground truth tensor</p></li>
</ul>
<p>and yields the value of the specified metric.</p>
</p></li>
<li><p><strong>model_output_transform</strong> (<a class="reference internal" href="hybrid_learning.datasets.transforms.tuple_transforms.TupleTransforms.html#hybrid_learning.datasets.transforms.tuple_transforms.TupleTransforms" title="hybrid_learning.datasets.transforms.tuple_transforms.TupleTransforms"><em>hybrid_learning.datasets.transforms.tuple_transforms.TupleTransforms</em></a>) – transformation applied to the tuples of
<code class="docutils literal notranslate"><span class="pre">(model</span> <span class="pre">output,</span> <span class="pre">target)</span></code> before applying loss functions or
metric functions;
the functions are wrapped correspondingly</p></li>
<li><p><strong>data</strong> (<a class="reference internal" href="hybrid_learning.datasets.base.DataTriple.html#hybrid_learning.datasets.base.DataTriple" title="hybrid_learning.datasets.base.DataTriple"><em>hybrid_learning.datasets.base.DataTriple</em></a>) – </p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – </p></li>
<li><p><strong>max_epochs</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle._evaluate">
<em class="property">classmethod </em><code class="sig-name descname">_evaluate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">kpi_fns</span></em>, <em class="sig-param"><span class="n">val_loader</span></em>, <em class="sig-param"><span class="n">prefix_</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">_unused_args</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/models/base_handles/train_test_handle.html#TrainEvalHandle._evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle._evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the model wrt. loss and <a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.metric_fns" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.metric_fns"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metric_fns</span></code></a>
on the test data.
The reduction method for the KPI values is <code class="docutils literal notranslate"><span class="pre">mean</span></code>.
The device used is the one of the model lies on (see
<a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.device_of" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.device_of"><code class="xref py py-meth docutils literal notranslate"><span class="pre">device_of()</span></code></a>). Distributed models are not supported.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.modules.module.Module</em>) – the model to evaluate</p></li>
<li><p><strong>kpi_fns</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em>, </em><em>Callable</em><em>]</em>) – dictionary with KPI IDs and evaluation functions for
the KPIs to evaluate</p></li>
<li><p><strong>val_loader</strong> (<em>torch.utils.data.dataloader.DataLoader</em>) – data loader with data to evaluate on</p></li>
<li><p><strong>prefix</strong> – wrapper to prefix KPI names for the final
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.Series</span></code></a> naming</p></li>
<li><p><strong>prefix_</strong> (<em>Callable</em><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary of all KPI values in the format:
<code class="docutils literal notranslate"><span class="pre">{&lt;KPI-name&gt;:</span> <span class="pre">&lt;KPI</span> <span class="pre">value</span> <span class="pre">as</span> <span class="pre">float&gt;}</span></code></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.core.series.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle._train_one_epoch">
<em class="property">classmethod </em><code class="sig-name descname">_train_one_epoch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">loss_fn</span></em>, <em class="sig-param"><span class="n">metric_fns</span></em>, <em class="sig-param"><span class="n">train_loader</span></em>, <em class="sig-param"><span class="n">optimizer</span></em>, <em class="sig-param"><span class="n">pbar</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">batch_info_templ</span><span class="o">=</span><span class="default_value">'Epoch ??/??\tBatch {batch}/{tot_batches}'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">_unused_args</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/models/base_handles/train_test_handle.html#TrainEvalHandle._train_one_epoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle._train_one_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Train for one epoch, evaluate, and return history and test results.
History and test results are stored in a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a>.
The device used is the one the model lies on. Distributed models are
not supported.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – model to train</p></li>
<li><p><strong>loss_fn</strong> – function that calculates the optimization objective
value</p></li>
<li><p><strong>metric_fns</strong> – further KPI functions to gather training stats</p></li>
<li><p><strong>train_loader</strong> (<em>torch.utils.data.dataloader.DataLoader</em>) – train data loader</p></li>
<li><p><strong>optimizer</strong> (<em>Union</em><em>[</em><em>torch.optim.optimizer.Optimizer</em><em>, </em><a class="reference internal" href="hybrid_learning.concepts.models.base_handles.resettable_optimizer.ResettableOptimizer.html#hybrid_learning.concepts.models.base_handles.resettable_optimizer.ResettableOptimizer" title="hybrid_learning.concepts.models.base_handles.resettable_optimizer.ResettableOptimizer"><em>hybrid_learning.concepts.models.base_handles.resettable_optimizer.ResettableOptimizer</em></a><em>]</em>) – optimizer to use for weight update steps
initialized with model’s weights</p></li>
<li><p><strong>pbar</strong> (<em>tqdm.std.tqdm</em>) – optional <code class="xref py py-class docutils literal notranslate"><span class="pre">tqdm.tqdm</span></code> progress bar which is
updated after each batch</p></li>
<li><p><strong>batch_info_templ</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – formatting template for logging
that contains as substring <code class="docutils literal notranslate"><span class="pre">{batch}</span></code> and <code class="docutils literal notranslate"><span class="pre">{tot_batches}</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>training history as <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with</p>
<dl class="field-list simple">
<dt class="field-odd">columns</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">loss</span></code> and the KPI names
(keys from dict <a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.metric_fns" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.metric_fns"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metric_fns</span></code></a>),</p>
</dd>
<dt class="field-even">index</dt>
<dd class="field-even"><p>the batch indices,</p>
</dd>
<dt class="field-odd">items</dt>
<dd class="field-odd"><p>the results of KPI evaluations of the output on the training
batch (i.e. <em>before</em> back-propagation step)</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pandas.core.frame.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.assess_learning_rates">
<code class="sig-name descname">assess_learning_rates</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">min_lr</span><span class="o">=</span><span class="default_value">1e-08</span></em>, <em class="sig-param"><span class="n">max_lr</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">lr_candidates</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">runs_per_lr</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">train_args</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/models/base_handles/train_test_handle.html#TrainEvalHandle.assess_learning_rates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.assess_learning_rates" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect mean and std deviation of loss for lr candidates via
cross-validation.
If no <code class="docutils literal notranslate"><span class="pre">lr_candidates</span></code> are given, candidates are chosen in a
logarithmic range from <code class="docutils literal notranslate"><span class="pre">min_lr</span></code> to <code class="docutils literal notranslate"><span class="pre">max_lr</span></code>, i.e.
<code class="docutils literal notranslate"><span class="pre">min_lr</span> <span class="pre">*</span> <span class="pre">(10**a)</span></code> for <code class="docutils literal notranslate"><span class="pre">a=0</span></code> to <code class="docutils literal notranslate"><span class="pre">int(log10(max_lr</span> <span class="pre">/</span> <span class="pre">min_lr))</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr_candidates</strong> (<em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a><em>]</em>) – learning rate candidate values to collect
performance values for</p></li>
<li><p><strong>min_lr</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – minimum learning rate to automatically determine
candidates; overridden by <code class="docutils literal notranslate"><span class="pre">lr_candidates</span></code></p></li>
<li><p><strong>max_lr</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – maximum learning rate to automatically determine
candidates; overridden by <code class="docutils literal notranslate"><span class="pre">lr_candidates</span></code></p></li>
<li><p><strong>runs_per_lr</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – number of cross-validation splits to make for each
learning rate candidate</p></li>
<li><p><strong>train_args</strong> – further arguments to override instance defaults for
the training runs, like <code class="docutils literal notranslate"><span class="pre">epochs</span></code>, <code class="docutils literal notranslate"><span class="pre">early_stopping_handle</span></code>
etc. (see <a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.train" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.train"><code class="xref py py-meth docutils literal notranslate"><span class="pre">train()</span></code></a>);
must not encompass <code class="docutils literal notranslate"><span class="pre">train_loader</span></code> or <code class="docutils literal notranslate"><span class="pre">val_loader</span></code>
(specify <code class="docutils literal notranslate"><span class="pre">train_val_data</span></code> instead)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> indexed by the learning rate
candidates with columns for mean and standard deviation of the
last epoch’s validation loss</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.cross_validate">
<code class="sig-name descname">cross_validate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">num_splits</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">train_val_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">run_info_templ</span><span class="o">=</span><span class="default_value">'Run {run}/{runs}'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">custom_args</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/models/base_handles/train_test_handle.html#TrainEvalHandle.cross_validate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.cross_validate" title="Permalink to this definition">¶</a></dt>
<dd><p>Record training results for <code class="docutils literal notranslate"><span class="pre">num_splits</span></code> distinct val splits.
The original model state dict is restored after training runs.
The model must feature a <code class="docutils literal notranslate"><span class="pre">reset_parameters()</span></code> method to reinitialize
between the runs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>run_info_templ</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – template containing as substring placeholders
<code class="docutils literal notranslate"><span class="pre">{run}</span></code> (the number of the current run) and <code class="docutils literal notranslate"><span class="pre">runs</span></code>
(the total number of runs);
the template is prefixed to <code class="docutils literal notranslate"><span class="pre">batch_info_templ</span></code> and
<code class="docutils literal notranslate"><span class="pre">pbar_desc_templ</span></code></p></li>
<li><p><strong>batch_size</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>]</em>) – optional <code class="docutils literal notranslate"><span class="pre">batch_size</span></code> to use for the loaders;
defaults to <a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.batch_size" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.batch_size"><code class="xref py py-attr docutils literal notranslate"><span class="pre">batch_size</span></code></a></p></li>
<li><p><strong>num_splits</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – number of equal-sized, distinct validation splits
to use</p></li>
<li><p><strong>train_val_data</strong> – optional given dataset to split into train and
validation dataset splits; defaults to the <code class="docutils literal notranslate"><span class="pre">train_val</span></code> split in
<a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.data" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code></a></p></li>
<li><p><strong>custom_args</strong> – further custom training args overriding defaults</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>list of tuples of the form</p>
<div class="line-block">
<div class="line">(</div>
<div class="line-block">
<div class="line">final <code class="docutils literal notranslate"><span class="pre">state_dict</span></code>,</div>
<div class="line">epoch- and batch-wise train history as
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a>,</div>
<div class="line">epoch-wise validation history as <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a></div>
</div>
<div class="line">)</div>
</div>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List[Tuple[Dict[<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)">str</a>, <a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.6.0a0+4392e52 ))">torch.Tensor</a>], pandas.core.frame.DataFrame, pandas.core.frame.DataFrame]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.device_of">
<em class="property">static </em><code class="sig-name descname">device_of</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/models/base_handles/train_test_handle.html#TrainEvalHandle.device_of"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.device_of" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the device of the given pytorch model.
Distributed models are not supported.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model</strong> (<em>torch.nn.modules.module.Module</em>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>torch.device</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.disable_early_stopping">
<code class="sig-name descname">disable_early_stopping</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/models/base_handles/train_test_handle.html#TrainEvalHandle.disable_early_stopping"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.disable_early_stopping" title="Permalink to this definition">¶</a></dt>
<dd><p>Disable early stopping.
This is done by setting <a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.early_stopping_handle" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.early_stopping_handle"><code class="xref py py-attr docutils literal notranslate"><span class="pre">early_stopping_handle</span></code></a> to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.evaluate">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">DatasetSplit.TEST</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">custom_args</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/models/base_handles/train_test_handle.html#TrainEvalHandle.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the model wrt. <a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.settings" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.settings"><code class="xref py py-attr docutils literal notranslate"><span class="pre">settings</span></code></a>.
This is a wrapper around <a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle._evaluate" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle._evaluate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_evaluate()</span></code></a> which uses the defaults
given by <a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.settings" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.settings"><code class="xref py py-attr docutils literal notranslate"><span class="pre">settings</span></code></a>.
Override them by specifying them as <code class="docutils literal notranslate"><span class="pre">custom_args</span></code>.
The device used for evaluation is the one of the model determined using
<a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.device_of" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.device_of"><code class="xref py py-meth docutils literal notranslate"><span class="pre">device_of()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em>, </em><a class="reference internal" href="hybrid_learning.datasets.base.DatasetSplit.html#hybrid_learning.datasets.base.DatasetSplit" title="hybrid_learning.datasets.base.DatasetSplit"><em>hybrid_learning.datasets.base.DatasetSplit</em></a><em>]</em>) – which data set to use; specify as instance of
<a class="reference internal" href="hybrid_learning.datasets.base.DatasetSplit.html#hybrid_learning.datasets.base.DatasetSplit" title="hybrid_learning.datasets.base.DatasetSplit"><code class="xref py py-class docutils literal notranslate"><span class="pre">DatasetSplit</span></code></a>
or the name of one</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – batch size used for the <code class="docutils literal notranslate"><span class="pre">val_loader</span></code> if that is
not given within <code class="docutils literal notranslate"><span class="pre">custom_args</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary of all KPIs, i.e. of <code class="docutils literal notranslate"><span class="pre">loss</span></code> and each metric
in <a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.metric_fns" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.metric_fns"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metric_fns</span></code></a>;
format: <code class="docutils literal notranslate"><span class="pre">{&lt;KPI-name&gt;:</span> <span class="pre">&lt;KPI</span> <span class="pre">value</span> <span class="pre">as</span> <span class="pre">float&gt;}</span></code></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.core.series.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.loader">
<code class="sig-name descname">loader</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">shuffle</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">device</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/models/base_handles/train_test_handle.html#TrainEvalHandle.loader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.loader" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare and return a torch data loader from the dataset
according to settings.
The settings include the device and batch size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.utils.data.dataset.Dataset</em>) – data to obtain loader for</p></li>
<li><p><strong>batch_size</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>]</em>) – the batch size to apply; defaults to
<a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.batch_size" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.batch_size"><code class="xref py py-attr docutils literal notranslate"><span class="pre">batch_size</span></code></a></p></li>
<li><p><strong>shuffle</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – Whether the loader should shuffle the data or not;
e.g. shuffle training data and do not shuffle evaluation data</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the desired device to work on
(determines whether to pin memory); currently unused</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a data loader for the given data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.utils.data.dataloader.DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.prefix_by">
<em class="property">classmethod </em><code class="sig-name descname">prefix_by</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mode</span></em>, <em class="sig-param"><span class="n">string</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/models/base_handles/train_test_handle.html#TrainEvalHandle.prefix_by"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.prefix_by" title="Permalink to this definition">¶</a></dt>
<dd><p>Prefix <code class="docutils literal notranslate"><span class="pre">s</span></code> with the given mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> (<a class="reference internal" href="hybrid_learning.datasets.base.DatasetSplit.html#hybrid_learning.datasets.base.DatasetSplit" title="hybrid_learning.datasets.base.DatasetSplit"><em>hybrid_learning.datasets.base.DatasetSplit</em></a>) – </p></li>
<li><p><strong>string</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.reset_optimizer">
<code class="sig-name descname">reset_optimizer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">optimizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">device</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">model</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/models/base_handles/train_test_handle.html#TrainEvalHandle.reset_optimizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.reset_optimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Move model to correct device, init optimizer to parameters of model.
By default apply to <a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.optimizer" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.optimizer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">optimizer</span></code></a>, <a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.device" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.device"><code class="xref py py-attr docutils literal notranslate"><span class="pre">device</span></code></a>,
<a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.model" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.model"><code class="xref py py-attr docutils literal notranslate"><span class="pre">model</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optimizer</strong> (<a class="reference internal" href="hybrid_learning.concepts.models.base_handles.resettable_optimizer.ResettableOptimizer.html#hybrid_learning.concepts.models.base_handles.resettable_optimizer.ResettableOptimizer" title="hybrid_learning.concepts.models.base_handles.resettable_optimizer.ResettableOptimizer"><em>hybrid_learning.concepts.models.base_handles.resettable_optimizer.ResettableOptimizer</em></a>) – </p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – </p></li>
<li><p><strong>model</strong> (<em>torch.nn.modules.module.Module</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.reset_training_handles">
<code class="sig-name descname">reset_training_handles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">optimizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">device</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">model</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/models/base_handles/train_test_handle.html#TrainEvalHandle.reset_training_handles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.reset_training_handles" title="Permalink to this definition">¶</a></dt>
<dd><p>(Re)set all handles associated with training, and move to <code class="docutils literal notranslate"><span class="pre">device</span></code>.
These are: <a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.optimizer" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.optimizer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">optimizer</span></code></a>, <a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.early_stopping_handle" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.early_stopping_handle"><code class="xref py py-attr docutils literal notranslate"><span class="pre">early_stopping_handle</span></code></a>,
and the data loaders.
The argument values default to the corresponding attributes of this
instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optimizer</strong> (<a class="reference internal" href="hybrid_learning.concepts.models.base_handles.resettable_optimizer.ResettableOptimizer.html#hybrid_learning.concepts.models.base_handles.resettable_optimizer.ResettableOptimizer" title="hybrid_learning.concepts.models.base_handles.resettable_optimizer.ResettableOptimizer"><em>hybrid_learning.concepts.models.base_handles.resettable_optimizer.ResettableOptimizer</em></a>) – </p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – </p></li>
<li><p><strong>model</strong> (<em>torch.nn.modules.module.Module</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.6/library/constants.html#None" title="(in Python v3.6)">None</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.test_">
<em class="property">classmethod </em><code class="sig-name descname">test_</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">metric_name</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/models/base_handles/train_test_handle.html#TrainEvalHandle.test_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.test_" title="Permalink to this definition">¶</a></dt>
<dd><p>Get name of metric for testing results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>metric_name</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.train">
<code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">epochs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">early_stopping_handle</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">batch_info_templ</span><span class="o">=</span><span class="default_value">'Epoch {epoch}/{tot_epochs}\tBatch {batch}/{tot_batches}\t'</span></em>, <em class="sig-param"><span class="n">show_progress_bars</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">pbar_desc_templ</span><span class="o">=</span><span class="default_value">'Epoch {epoch}/{tot_epochs}'</span></em>, <em class="sig-param"><span class="n">device</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">custom_args</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/models/base_handles/train_test_handle.html#TrainEvalHandle.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train the model according to the specified training parameters.
Defaults are taken from <a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.settings" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.settings"><code class="xref py py-attr docutils literal notranslate"><span class="pre">settings</span></code></a>.
To override specify <code class="docutils literal notranslate"><span class="pre">custom_args</span></code> (compare arguments to
<a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.train_val_one_epoch" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.train_val_one_epoch"><code class="xref py py-attr docutils literal notranslate"><span class="pre">train_val_one_epoch</span></code></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>early_stopping_handle</strong> (<a class="reference internal" href="hybrid_learning.concepts.models.base_handles.early_stopping.EarlyStoppingHandle.html#hybrid_learning.concepts.models.base_handles.early_stopping.EarlyStoppingHandle" title="hybrid_learning.concepts.models.base_handles.early_stopping.EarlyStoppingHandle"><em>hybrid_learning.concepts.models.base_handles.early_stopping.EarlyStoppingHandle</em></a>) – handle for early stopping;
set to <code class="docutils literal notranslate"><span class="pre">False</span></code> to disable;
make sure it is reset if handle given and this is required!</p></li>
<li><p><strong>epochs</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – maximum number of epochs to run</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – the device on which to run training and evaluation</p></li>
<li><p><strong>show_progress_bars</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – whether to verbosely show the progress using
<code class="xref py py-class docutils literal notranslate"><span class="pre">tqdm.tqdm</span></code> progress bar</p></li>
<li><p><strong>batch_info_templ</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – <p>string template for logging epoch and batch,
including as substring</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">{epoch}</span></code>: the current epoch number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{tot_epoch}</span></code>: total number of epochs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{batch}</span></code>: the current batch number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{tot_batches}</span></code>: total number of batches</p></li>
</ul>
</p></li>
<li><p><strong>pbar_desc_templ</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – <p>template for the progress bar description;
must accept as substring</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">{epoch}</span></code>: the current epoch number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{tot_epoch}</span></code>: the total number of epochs</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Two <cite>pandas.DataFrame</cite> with history information on</p>
<ul class="simple">
<li><p><em>training</em>: the epoch- and batch-wise loss and KPI results on the
training data,
index is a multi-index of <code class="docutils literal notranslate"><span class="pre">(epoch,</span> <span class="pre">batch)</span></code>;</p></li>
<li><p><em>test</em>: the epoch-wise evaluation results on the test set;
index is the epoch index;</p></li>
</ul>
<p>columns for both are <code class="docutils literal notranslate"><span class="pre">loss</span></code> and KPI names
(keys of <a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.metric_fns" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.metric_fns"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metric_fns</span></code></a>)</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[pandas.core.frame.DataFrame, pandas.core.frame.DataFrame]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.train_">
<em class="property">classmethod </em><code class="sig-name descname">train_</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">metric_name</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/models/base_handles/train_test_handle.html#TrainEvalHandle.train_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.train_" title="Permalink to this definition">¶</a></dt>
<dd><p>Get name of metric for training results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>metric_name</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.train_loader">
<code class="sig-name descname">train_loader</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">device</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/models/base_handles/train_test_handle.html#TrainEvalHandle.train_loader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.train_loader" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a loader for the train data with default settings.
Train data is retrieved from the <a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.data" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code></a> triple.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> (<em>torch.device</em>) – </p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>torch.utils.data.dataloader.DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.train_one_epoch">
<code class="sig-name descname">train_one_epoch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">show_progress_bar</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">pbar</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pbar_desc</span><span class="o">=</span><span class="default_value">'Epoch ??/??'</span></em>, <em class="sig-param"><span class="n">batch_info_templ</span><span class="o">=</span><span class="default_value">'Epoch ??/??\tBatch {batch}/{tot_batches}'</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">custom_args</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/models/base_handles/train_test_handle.html#TrainEvalHandle.train_one_epoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.train_one_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Train for one epoch and return history results as
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a>.
This is a wrapper around <a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle._train_one_epoch" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle._train_one_epoch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_train_one_epoch()</span></code></a> that uses
defaults from <a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.settings" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.settings"><code class="xref py py-attr docutils literal notranslate"><span class="pre">settings</span></code></a>.
Override the defaults by specifying <code class="docutils literal notranslate"><span class="pre">custom_args</span></code> (but watch out
that model and optimizer fit together, if any of them is overridden!).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pbar</strong> (<em>tqdm.std.tqdm</em>) – optional progress bar; hand over if more control over
the progress bar is required</p></li>
<li><p><strong>show_progress_bar</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – whether to log the batch progress,
training latest loss and metrics using <code class="xref py py-class docutils literal notranslate"><span class="pre">tqdm.tqdm</span></code></p></li>
<li><p><strong>batch_info_templ</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – formatting template for logging that contains
as substring <code class="docutils literal notranslate"><span class="pre">{batch}</span></code> and <code class="docutils literal notranslate"><span class="pre">{tot_batches}</span></code></p></li>
<li><p><strong>pbar_desc</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – leading static description text for the progress bar
if newly created</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – batch size for the <code class="docutils literal notranslate"><span class="pre">train_loader</span></code> if this is not
given in <code class="docutils literal notranslate"><span class="pre">custom_args</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>tuple of training history and test results as
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with:</p>
<dl class="field-list simple">
<dt class="field-odd">columns</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">loss</span></code> and the KPI names
(keys from dict <a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.metric_fns" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.metric_fns"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metric_fns</span></code></a>),</p>
</dd>
<dt class="field-even">index</dt>
<dd class="field-even"><p>the batch indices,</p>
</dd>
<dt class="field-odd">items</dt>
<dd class="field-odd"><p>the results of KPI evaluations of the output on the training
batch (i.e. <em>before</em> back-propagation step)</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pandas.core.frame.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.train_val_one_epoch">
<code class="sig-name descname">train_val_one_epoch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">show_progress_bar</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">pbar_desc</span><span class="o">=</span><span class="default_value">'Epoch ??/??'</span></em>, <em class="sig-param"><span class="n">batch_info_templ</span><span class="o">=</span><span class="default_value">'Epoch ??/??\tBatch {batch}/{tot_batches}'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">custom_args</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/models/base_handles/train_test_handle.html#TrainEvalHandle.train_val_one_epoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.train_val_one_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Train for one epoch, evaluate, and return history and test results.
This is a wrapper around <a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.train_one_epoch" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.train_one_epoch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">train_one_epoch()</span></code></a> and
<a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.evaluate" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.evaluate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">evaluate()</span></code></a> with nice progress bar printing and logging after
the epoch.
History and test results are stored in a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a>.
The device used for training is that of the parameters of the used
model (see <a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.device_of" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.device_of"><code class="xref py py-meth docutils literal notranslate"><span class="pre">device_of()</span></code></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>show_progress_bar</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – whether to log the batch progress, training
latest loss and metrics using <code class="xref py py-class docutils literal notranslate"><span class="pre">tqdm.tqdm</span></code></p></li>
<li><p><strong>batch_info_templ</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – formatting template for logging that
contains as substring <code class="docutils literal notranslate"><span class="pre">{batch}</span></code> and <code class="docutils literal notranslate"><span class="pre">{tot_batches}</span></code></p></li>
<li><p><strong>pbar_desc</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – leading static description text for the progress bar</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>tuple of training history and test results; columns resp.
index are <code class="docutils literal notranslate"><span class="pre">loss</span></code> and the KPI names
(keys from dict <a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.metric_fns" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.metric_fns"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metric_fns</span></code></a>).</p>
<ul class="simple">
<li><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a>: index are the batch indices,
items are the results of KPI evaluations of the output on the
training batch (i.e. before back-propagation step)</p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.Series</span></code></a>: the items are the final evaluations of
the KPIs on the validation set</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[pandas.core.frame.DataFrame, pandas.core.series.Series]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.val_">
<em class="property">classmethod </em><code class="sig-name descname">val_</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">metric_name</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/models/base_handles/train_test_handle.html#TrainEvalHandle.val_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.val_" title="Permalink to this definition">¶</a></dt>
<dd><p>Get name of metric for validation results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>metric_name</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.LOSS_KEY">
<code class="sig-name descname">LOSS_KEY</code><em class="property"> = 'loss'</em><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.LOSS_KEY" title="Permalink to this definition">¶</a></dt>
<dd><p>Key for the loss evaluation results.</p>
</dd></dl>

<dl class="py attribute">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.batch_size">
<code class="sig-name descname">batch_size</code><em class="property">: <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)">int</a></em><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.batch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Default batch size.</p>
</dd></dl>

<dl class="py attribute">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.data">
<code class="sig-name descname">data</code><em class="property">: DataTriple</em><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.data" title="Permalink to this definition">¶</a></dt>
<dd><p>Train, validation, and test data splits to use.
Must be converted to data loaders before usage.</p>
</dd></dl>

<dl class="py attribute">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.device">
<code class="sig-name descname">device</code><em class="property">: torch.device</em><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.device" title="Permalink to this definition">¶</a></dt>
<dd><p>Device to run training and testing on (this is where the data
loaders are put).</p>
</dd></dl>

<dl class="py attribute">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.early_stopping_handle">
<code class="sig-name descname">early_stopping_handle</code><em class="property">: Optional<span class="p">[</span>EarlyStoppingHandle<span class="p">]</span></em><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.early_stopping_handle" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle that is stepped during training and indicates need for
early stopping.
To disable early stopping, set <a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.early_stopping_handle" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.early_stopping_handle"><code class="xref py py-attr docutils literal notranslate"><span class="pre">early_stopping_handle</span></code></a> to
<code class="docutils literal notranslate"><span class="pre">None</span></code> resp. specify <code class="docutils literal notranslate"><span class="pre">early_stopping_handle=False</span></code> in
<code class="docutils literal notranslate"><span class="pre">__init__</span></code> arguments.</p>
</dd></dl>

<dl class="py attribute">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.epochs">
<code class="sig-name descname">epochs</code><em class="property">: <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)">int</a></em><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.epochs" title="Permalink to this definition">¶</a></dt>
<dd><p>Default maximum number of epochs.
May be reduced by <a class="reference internal" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.early_stopping_handle" title="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.early_stopping_handle"><code class="xref py py-attr docutils literal notranslate"><span class="pre">early_stopping_handle</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.loss_fn">
<code class="sig-name descname">loss_fn</code><em class="property">: Callable<span class="p">[</span><span class="p">[</span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.6.0a0+4392e52 ))">torch.Tensor</a><span class="p">, </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.6.0a0+4392e52 ))">torch.Tensor</a><span class="p">]</span><span class="p">, </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.6.0a0+4392e52 ))">torch.Tensor</a><span class="p">]</span></em><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.loss_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>Loss function callable.
Defaults to a balanced binary cross-entropy assuming on average 1%
positive px per img.
Must be wrapped into a tuple to hide the parameters, since these are
not to be updated.</p>
</dd></dl>

<dl class="py attribute">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.metric_fns">
<code class="sig-name descname">metric_fns</code><em class="property">: Dict<span class="p">[</span><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)">str</a><span class="p">, </span>Callable<span class="p">[</span><span class="p">[</span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.6.0a0+4392e52 ))">torch.Tensor</a><span class="p">, </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.6.0a0+4392e52 ))">torch.Tensor</a><span class="p">]</span><span class="p">, </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.6.0a0+4392e52 ))">torch.Tensor</a><span class="p">]</span><span class="p">]</span></em><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.metric_fns" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of metric functions to apply for evaluation and logging.
Each function must have a signature of
<code class="docutils literal notranslate"><span class="pre">(output,</span> <span class="pre">target)</span> <span class="pre">-&gt;</span> <span class="pre">metric_value</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.model">
<code class="sig-name descname">model</code><em class="property">: <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch vmaster (1.6.0a0+4392e52 ))">torch.nn.Module</a></em><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.model" title="Permalink to this definition">¶</a></dt>
<dd><p>The model to work on.</p>
</dd></dl>

<dl class="py attribute">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.optimizer">
<code class="sig-name descname">optimizer</code><em class="property">: ResettableOptimizer</em><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.optimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimizer and learning rate scheduler handle.</p>
</dd></dl>

<dl class="py method">
<dt id="hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.settings">
<em class="property">property </em><code class="sig-name descname">settings</code><a class="headerlink" href="#hybrid_learning.concepts.models.base_handles.train_test_handle.TrainEvalHandle.settings" title="Permalink to this definition">¶</a></dt>
<dd><p>The current training settings as dictionary.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="hybrid_learning.concepts.models.concept_detection.html" class="btn btn-neutral float-right" title="concept_detection" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="hybrid_learning.concepts.models.base_handles.train_test_handle.html" class="btn btn-neutral float-left" title="train_test_handle" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Continental Automotive GmbH

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>