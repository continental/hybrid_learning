<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ConceptSegmentation2DTrainTestHandle &mdash; hybrid_learning  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/autoclasstoc.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="ConceptSegmentationModel2D" href="hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentationModel2D.html" />
    <link rel="prev" title="concept_segmentation" href="hybrid_learning.concepts.models.concept_models.concept_segmentation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> hybrid_learning
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Content</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/index.html">Quickstart Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../userguide/index.html">User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="hybrid_learning.concepts.html">concepts</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="hybrid_learning.concepts.analysis.html">analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="hybrid_learning.concepts.concepts.html">concepts</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="hybrid_learning.concepts.models.html">models</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="hybrid_learning.concepts.models.concept_models.html">concept_models</a></li>
<li class="toctree-l4"><a class="reference internal" href="hybrid_learning.concepts.models.embeddings.html">embeddings</a></li>
<li class="toctree-l4"><a class="reference internal" href="hybrid_learning.concepts.models.model_extension.html">model_extension</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hybrid_learning.concepts.train_eval.html">train_eval</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="hybrid_learning.datasets.html">datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="hybrid_learning.fuzzy_logic.html">fuzzy_logic</a></li>
<li class="toctree-l2"><a class="reference internal" href="hybrid_learning.experimentation.html">experimentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">How to contribute</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">hybrid_learning</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">API Reference</a> &raquo;</li>
          <li><a href="hybrid_learning.concepts.html">concepts</a> &raquo;</li>
          <li><a href="hybrid_learning.concepts.models.html">models</a> &raquo;</li>
          <li><a href="hybrid_learning.concepts.models.concept_models.html">concept_models</a> &raquo;</li>
          <li><a href="hybrid_learning.concepts.models.concept_models.concept_segmentation.html">concept_segmentation</a> &raquo;</li>
      <li>ConceptSegmentation2DTrainTestHandle</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/apiref/generated/hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="conceptsegmentation2dtraintesthandle">
<h1>ConceptSegmentation2DTrainTestHandle<a class="headerlink" href="#conceptsegmentation2dtraintesthandle" title="Permalink to this headline"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hybrid_learning.concepts.models.concept_models.concept_segmentation.</span></span><span class="sig-name descname"><span class="pre">ConceptSegmentation2DTrainTestHandle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">concept_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_input_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hybrid_learning/concepts/models/concept_models/concept_segmentation.html#ConceptSegmentation2DTrainTestHandle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="hybrid_learning.concepts.models.concept_models.concept_detection.ConceptDetection2DTrainTestHandle.html#hybrid_learning.concepts.models.concept_models.concept_detection.ConceptDetection2DTrainTestHandle" title="hybrid_learning.concepts.models.concept_models.concept_detection.ConceptDetection2DTrainTestHandle"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConceptDetection2DTrainTestHandle</span></code></a></p>
<p>Train and test handle for concept segmentation providing loss and
metric defaults.
See <a class="reference internal" href="hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentationModel2D.html#hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentationModel2D" title="hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentationModel2D"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConceptSegmentationModel2D</span></code></a> for details on the model.</p>
<div class="autoclasstoc docutils container">
<p class="rubric">Public Data Attributes:</p>
<details><summary>Inherited from    : py: class:<cite>ConceptDetection2DTrainTestHandle</cite></summary><table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">DEFAULT_MASK_INTERPOLATION</span></code></p></td>
<td><p>Interpolation method used in default transforms for resizing masks to activation map size.</p></td>
</tr>
</tbody>
</table>
</details><details><summary>Inherited from    : py: class:<cite>TrainEvalHandle</cite></summary><table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">LOSS_KEY</span></code></p></td>
<td><p>Key for the loss evaluation results.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">NLL_KEY</span></code></p></td>
<td><p>Key for the proper scoring evaluation function used for second stage training.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">kpi_fns</span></code></p></td>
<td><p>Metric <em>and</em> loss functions.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">settings</span></code></p></td>
<td><p>The current training settings as dictionary.</p></td>
</tr>
</tbody>
</table>
</details></div>
<div class="autoclasstoc docutils container">
<p class="rubric">Public Methods:</p>
<details><summary>Inherited from    : py: class:<cite>TrainEvalHandle</cite></summary><table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_callbacks</span></code>(callbacks)</p></td>
<td><p>Append the given callbacks.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_callback</span></code>(callback)</p></td>
<td><p>Remove a single given callback.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">loader</span></code>([data, mode, batch_size, shuffle, ...])</p></td>
<td><p>Prepare and return a torch data loader from the dataset according to settings.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset_optimizer</span></code>([optimizer, device, model])</p></td>
<td><p>Move model to correct device, init optimizer to parameters of model.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset_training_handles</span></code>([optimizer, device, ...])</p></td>
<td><p>(Re)set all handles associated with training, and move to <code class="docutils literal notranslate"><span class="pre">device</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset_kpis</span></code>([kpis])</p></td>
<td><p>Resets aggregating kpis</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code>([train_loader, val_loader, ...])</p></td>
<td><p>Train the model according to the specified training parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cross_validate</span></code>([num_splits, train_val_data, ...])</p></td>
<td><p>Record training results for <code class="docutils literal notranslate"><span class="pre">num_splits</span></code> distinct val splits.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_val_one_epoch</span></code>([pbar_desc, ...])</p></td>
<td><p>Train for one epoch, evaluate, and return history and test results.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_one_epoch</span></code>([train_loader, ...])</p></td>
<td><p>Train for one epoch and return history results as <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code>([mode, val_loader, prefix, ...])</p></td>
<td><p>Evaluate the model wrt.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">second_stage_train</span></code>([callback_context])</p></td>
<td><p>Do a second stage training for calibration using Laplace approximation.</p></td>
</tr>
</tbody>
</table>
</details></div>
<div class="autoclasstoc docutils container">
<p class="rubric">Special Methods:</p>
<details><summary>Inherited from    : py: class:<cite>ConceptDetection2DTrainTestHandle</cite></summary><table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code>(concept_model, data, *[, ...])</p></td>
<td><p>Init.</p></td>
</tr>
</tbody>
</table>
</details><details><summary>Inherited from    : py: class:<cite>TrainEvalHandle</cite></summary><table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__repr__</span></code>()</p></td>
<td><p>Return repr(self).</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code>(concept_model, data, *[, ...])</p></td>
<td><p>Init.</p></td>
</tr>
</tbody>
</table>
</details></div>
<hr class="docutils" />
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>concept_model</strong> (<a class="reference internal" href="hybrid_learning.concepts.models.concept_models.concept_detection.ConceptDetectionModel2D.html#hybrid_learning.concepts.models.concept_models.concept_detection.ConceptDetectionModel2D" title="hybrid_learning.concepts.models.concept_models.concept_detection.ConceptDetectionModel2D"><em>ConceptDetectionModel2D</em></a>) – </p></li>
<li><p><strong>data</strong> (<a class="reference internal" href="hybrid_learning.datasets.base.DataTriple.html#hybrid_learning.datasets.base.DataTriple" title="hybrid_learning.datasets.base.DataTriple"><em>DataTriple</em></a>) – </p></li>
<li><p><strong>model_output_transform</strong> (<a class="reference internal" href="hybrid_learning.datasets.transforms.tuple_transforms.TupleTransforms.html#hybrid_learning.datasets.transforms.tuple_transforms.TupleTransforms" title="hybrid_learning.datasets.transforms.tuple_transforms.TupleTransforms"><em>TupleTransforms</em></a>) – </p></li>
<li><p><strong>metric_input_transform</strong> (<a class="reference internal" href="hybrid_learning.datasets.transforms.tuple_transforms.TupleTransforms.html#hybrid_learning.datasets.transforms.tuple_transforms.TupleTransforms" title="hybrid_learning.datasets.transforms.tuple_transforms.TupleTransforms"><em>TupleTransforms</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.batch_size">
<span class="sig-name descname"><span class="pre">batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><span class="pre">int</span></a></em><a class="headerlink" href="#hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.batch_size" title="Permalink to this definition"></a></dt>
<dd><p>Default training batch size.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.batch_size_hessian">
<span class="sig-name descname"><span class="pre">batch_size_hessian</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><span class="pre">int</span></a></em><a class="headerlink" href="#hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.batch_size_hessian" title="Permalink to this definition"></a></dt>
<dd><p>Default batch size for calculating the hessian.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.batch_size_val">
<span class="sig-name descname"><span class="pre">batch_size_val</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><span class="pre">int</span></a></em><a class="headerlink" href="#hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.batch_size_val" title="Permalink to this definition"></a></dt>
<dd><p>Default validation batch size.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.callback_context">
<span class="sig-name descname"><span class="pre">callback_context</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.callback_context" title="Permalink to this definition"></a></dt>
<dd><p>The default callback context values to use.
In any training run where context is used, the context can either be
handed over or it defaults to a copy of this dict.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.callbacks">
<span class="sig-name descname"><span class="pre">callbacks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="hybrid_learning.concepts.train_eval.callbacks.CallbackEvents.html#hybrid_learning.concepts.train_eval.callbacks.CallbackEvents" title="hybrid_learning.concepts.train_eval.callbacks.CallbackEvents"><span class="pre">CallbackEvents</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.callbacks" title="Permalink to this definition"></a></dt>
<dd><p>A dictionary mapping events to a list of callables that are called
every time the event occurs with the current state.
Some default logging callbacks are defined.</p>
<p>For details on available events, see
<a class="reference internal" href="hybrid_learning.concepts.train_eval.callbacks.CallbackEvents.html#hybrid_learning.concepts.train_eval.callbacks.CallbackEvents" title="hybrid_learning.concepts.train_eval.callbacks.CallbackEvents"><code class="xref py py-class docutils literal notranslate"><span class="pre">hybrid_learning.concepts.train_eval.callbacks.CallbackEvents</span></code></a>.
After the event, all callbacks for this event are called in order
with keyword arguments from a
<a class="reference internal" href="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.html#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.callback_context" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.callback_context"><code class="xref py py-attr docutils literal notranslate"><span class="pre">hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.callback_context</span></code></a>.
The base context is dependent on the event and includes e.g. the model,
and can be extended by specifying the callback context during
function call or in the default callback context.
Note that side effects on objects in the callback context (e.g. the
model) will influence the training.
Callback application examples:</p>
<ul class="simple">
<li><p>Logging</p></li>
<li><p>Storing of best n models</p></li>
<li><p>Results saving, e.g. to tensorboard or sacred log</p></li>
<li><p>Forced weight normalization</p></li>
</ul>
<p>Callbacks can be
<a class="reference internal" href="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.html#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.add_callbacks" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.add_callbacks"><code class="xref py py-meth docutils literal notranslate"><span class="pre">added</span></code></a>
and
<a class="reference internal" href="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.html#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.remove_callback" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.remove_callback"><code class="xref py py-meth docutils literal notranslate"><span class="pre">removed</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.data">
<span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="hybrid_learning.datasets.base.DataTriple.html#hybrid_learning.datasets.base.DataTriple" title="hybrid_learning.datasets.base.DataTriple"><span class="pre">DataTriple</span></a></em><a class="headerlink" href="#hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.data" title="Permalink to this definition"></a></dt>
<dd><p>Train, validation, and test data splits to use.
Must be converted to data loaders before usage.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.device">
<span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.device</span></em><a class="headerlink" href="#hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.device" title="Permalink to this definition"></a></dt>
<dd><p>Device to run training and testing on (this is where the data
loaders are put).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.early_stopping_handle">
<span class="sig-name descname"><span class="pre">early_stopping_handle</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="hybrid_learning.concepts.train_eval.base_handles.early_stopping.EarlyStoppingHandle.html#hybrid_learning.concepts.train_eval.base_handles.early_stopping.EarlyStoppingHandle" title="hybrid_learning.concepts.train_eval.base_handles.early_stopping.EarlyStoppingHandle"><span class="pre">EarlyStoppingHandle</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.early_stopping_handle" title="Permalink to this definition"></a></dt>
<dd><p>Handle that is stepped during training and indicates need for
early stopping.
To disable early stopping, set <a class="reference internal" href="#hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.early_stopping_handle" title="hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.early_stopping_handle"><code class="xref py py-attr docutils literal notranslate"><span class="pre">early_stopping_handle</span></code></a> to
<code class="docutils literal notranslate"><span class="pre">None</span></code> resp. specify <code class="docutils literal notranslate"><span class="pre">early_stopping_handle=False</span></code> in
<code class="docutils literal notranslate"><span class="pre">__init__</span></code> arguments.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.epochs">
<span class="sig-name descname"><span class="pre">epochs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><span class="pre">int</span></a></em><a class="headerlink" href="#hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.epochs" title="Permalink to this definition"></a></dt>
<dd><p>Default maximum number of epochs.
May be reduced by <a class="reference internal" href="#hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.early_stopping_handle" title="hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.early_stopping_handle"><code class="xref py py-attr docutils literal notranslate"><span class="pre">early_stopping_handle</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.loss_fn">
<span class="sig-name descname"><span class="pre">loss_fn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.loss_fn" title="Permalink to this definition"></a></dt>
<dd><p>Loss function callable.
Defaults to a balanced binary cross-entropy assuming on average 1%
positive px per img.
Must be wrapped into a tuple to hide the parameters, since these are
not to be updated.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.metric_fns">
<span class="sig-name descname"><span class="pre">metric_fns</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="hybrid_learning.concepts.train_eval.kpis.aggregating_kpis.AggregatingKpi.html#hybrid_learning.concepts.train_eval.kpis.aggregating_kpis.AggregatingKpi" title="hybrid_learning.concepts.train_eval.kpis.aggregating_kpis.AggregatingKpi"><span class="pre">AggregatingKpi</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.metric_fns" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary of metric functions to apply for evaluation and logging.
Each function must have a signature of
<code class="docutils literal notranslate"><span class="pre">(output,</span> <span class="pre">target)</span> <span class="pre">-&gt;</span> <span class="pre">metric_value</span></code>. See also <code class="xref py py-attr docutils literal notranslate"><span class="pre">kpi_fns</span></code>.
Keys must not contain <code class="xref py py-const docutils literal notranslate"><span class="pre">LOSS_KEY</span></code> or <code class="xref py py-const docutils literal notranslate"><span class="pre">NLL_KEY</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.model">
<span class="sig-name descname"><span class="pre">model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="hybrid_learning.concepts.models.concept_models.concept_detection.ConceptDetectionModel2D.html#hybrid_learning.concepts.models.concept_models.concept_detection.ConceptDetectionModel2D" title="hybrid_learning.concepts.models.concept_models.concept_detection.ConceptDetectionModel2D"><span class="pre">ConceptDetectionModel2D</span></a></em><a class="headerlink" href="#hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.model" title="Permalink to this definition"></a></dt>
<dd><p>The model to work on.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.nll_fn">
<span class="sig-name descname"><span class="pre">nll_fn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v1.11.0)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.nll_fn" title="Permalink to this definition"></a></dt>
<dd><p>Proper scoring function callable used as loss in second stage
training for Laplace approximation.
Usually is chosen as negative log-likelihood, defaults to
<a class="reference internal" href="#hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.loss_fn" title="hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.loss_fn"><code class="xref py py-attr docutils literal notranslate"><span class="pre">loss_fn</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.num_workers">
<span class="sig-name descname"><span class="pre">num_workers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><span class="pre">int</span></a></em><a class="headerlink" href="#hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.num_workers" title="Permalink to this definition"></a></dt>
<dd><p>The default number of workers to use for data loading.
See <a class="reference internal" href="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.html#hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.loader" title="hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.loader"><code class="xref py py-meth docutils literal notranslate"><span class="pre">hybrid_learning.concepts.train_eval.base_handles.train_test_handle.TrainEvalHandle.loader()</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.optimizer">
<span class="sig-name descname"><span class="pre">optimizer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="hybrid_learning.concepts.train_eval.base_handles.resettable_optimizer.ResettableOptimizer.html#hybrid_learning.concepts.train_eval.base_handles.resettable_optimizer.ResettableOptimizer" title="hybrid_learning.concepts.train_eval.base_handles.resettable_optimizer.ResettableOptimizer"><span class="pre">ResettableOptimizer</span></a></em><a class="headerlink" href="#hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.optimizer" title="Permalink to this definition"></a></dt>
<dd><p>Optimizer and learning rate scheduler handle.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.show_progress_bars">
<span class="sig-name descname"><span class="pre">show_progress_bars</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><span class="pre">str</span></a></em><a class="headerlink" href="#hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentation2DTrainTestHandle.show_progress_bars" title="Permalink to this definition"></a></dt>
<dd><p>Whether to show progress bars for batch-wise operations.
Value must be a comma-separated concatenation of run types
(the values of dataset splits) for which to show progress,
or <code class="docutils literal notranslate"><span class="pre">'always'</span></code>.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="hybrid_learning.concepts.models.concept_models.concept_segmentation.html" class="btn btn-neutral float-left" title="concept_segmentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="hybrid_learning.concepts.models.concept_models.concept_segmentation.ConceptSegmentationModel2D.html" class="btn btn-neutral float-right" title="ConceptSegmentationModel2D" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Continental Automotive GmbH.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>